{"version":3,"sources":["node_modules/browser-pack/_prelude.js","node_modules/events/events.js","main.js","src/js/main.js","src/js/map.js","src/js/overlay.js","src/js/police-api.js"],"names":["e","t","n","r","s","o","u","a","require","i","f","Error","code","l","exports","call","length",1,"module","EventEmitter","this","_events","_maxListeners","undefined","isFunction","arg","isNumber","isObject","isUndefined","prototype","defaultMaxListeners","setMaxListeners","isNaN","TypeError","emit","type","er","handler","len","args","listeners","error","arguments","Array","slice","apply","addListener","listener","m","newListener","push","warned","console","trace","on","once","g","removeListener","fired","list","position","splice","removeAllListeners","key","ret","listenerCount","evlistener","emitter",2,"_interopRequireDefault","obj","__esModule","default","_map","_map2","_overlay","_overlay2","$map","document","getElementsByClassName","mapDefaults","center","lat","lng","zoom","map","el","defaults","input","getElementById","countryCode","overlay","window","App","./map.js","./overlay.js",3,"_classCallCheck","instance","Constructor","_possibleConstructorReturn","self","ReferenceError","_inherits","subClass","superClass","Object","create","constructor","value","enumerable","writable","configurable","setPrototypeOf","__proto__","defineProperty","_typeof","Symbol","iterator","_createClass","defineProperties","target","props","descriptor","protoProps","staticProps","Map","_EventEmitter","_this","getPrototypeOf","date","Date","now","body","settings","markers","google","hasOwnProperty","initMap","script","createElement","src","defer","async","appendChild","bind","assign","streetViewControl","maps","geocoder","Geocoder","autocomplete","places","Autocomplete","types","componentRestrictions","country","placeChanged","place","getPlace","msg","data","bounds","north","geometry","viewport","R","j","east","south","west","setOptions","location","rectangle","setBounds","Rectangle","fillColor","fillOpacity","strokeColor","strokeOpacity","strokeWeight","forEach","marker","Marker","clearMarkers","arr","setMap","_key","events",4,"_policeApi","Overlay","mapData","poly","$place","$overlay","$submit","$year","$month","$policeData","eventFns","click","change","possibleDates","loading","maxDate","policeData","requestEnd","requestStart","crimes","isOpen","isClosing","lastUpdated","err","split","getTime","init","currentDate","keys","year","month","$options","endDate","_year","getFullYear","_month","getMonth","setMonth","innerHTML","join","getElementsByTagName","setMonths","monthToSelect","months","createPoly","log","res","changeData","str","_this2","setTimeout","classList","add","_this3","requestDiff","category","replace","text","charAt","toUpperCase","substr","trim","formattedDate","updateMap","closeOverlay","getData","callback","policeDataFn","_this4","removeMarkers","style","transitionDelay","remove","getAttribute","contains","parseFloat","latitude","longitude","addMarkers","root","oTarget","fns","_","isArray","found","isSameNode","parentElement","fn","generateDates","gotPlace","mapError","addEventListener","eventHandler","yearChange","submitClick","dataClick","./police-api.js",5,"fetch","endpoint","then","status","json","statusText"],"mappings":"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","file":"main.min.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\nfunction EventEmitter() {\n  this._events = this._events || {};\n  this._maxListeners = this._maxListeners || undefined;\n}\nmodule.exports = EventEmitter;\n\n// Backwards-compat with node 0.10.x\nEventEmitter.EventEmitter = EventEmitter;\n\nEventEmitter.prototype._events = undefined;\nEventEmitter.prototype._maxListeners = undefined;\n\n// By default EventEmitters will print a warning if more than 10 listeners are\n// added to it. This is a useful default which helps finding memory leaks.\nEventEmitter.defaultMaxListeners = 10;\n\n// Obviously not all Emitters should be limited to 10. This function allows\n// that to be increased. Set to zero for unlimited.\nEventEmitter.prototype.setMaxListeners = function(n) {\n  if (!isNumber(n) || n < 0 || isNaN(n))\n    throw TypeError('n must be a positive number');\n  this._maxListeners = n;\n  return this;\n};\n\nEventEmitter.prototype.emit = function(type) {\n  var er, handler, len, args, i, listeners;\n\n  if (!this._events)\n    this._events = {};\n\n  // If there is no 'error' event listener then throw.\n  if (type === 'error') {\n    if (!this._events.error ||\n        (isObject(this._events.error) && !this._events.error.length)) {\n      er = arguments[1];\n      if (er instanceof Error) {\n        throw er; // Unhandled 'error' event\n      }\n      throw TypeError('Uncaught, unspecified \"error\" event.');\n    }\n  }\n\n  handler = this._events[type];\n\n  if (isUndefined(handler))\n    return false;\n\n  if (isFunction(handler)) {\n    switch (arguments.length) {\n      // fast cases\n      case 1:\n        handler.call(this);\n        break;\n      case 2:\n        handler.call(this, arguments[1]);\n        break;\n      case 3:\n        handler.call(this, arguments[1], arguments[2]);\n        break;\n      // slower\n      default:\n        args = Array.prototype.slice.call(arguments, 1);\n        handler.apply(this, args);\n    }\n  } else if (isObject(handler)) {\n    args = Array.prototype.slice.call(arguments, 1);\n    listeners = handler.slice();\n    len = listeners.length;\n    for (i = 0; i < len; i++)\n      listeners[i].apply(this, args);\n  }\n\n  return true;\n};\n\nEventEmitter.prototype.addListener = function(type, listener) {\n  var m;\n\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  if (!this._events)\n    this._events = {};\n\n  // To avoid recursion in the case that type === \"newListener\"! Before\n  // adding it to the listeners, first emit \"newListener\".\n  if (this._events.newListener)\n    this.emit('newListener', type,\n              isFunction(listener.listener) ?\n              listener.listener : listener);\n\n  if (!this._events[type])\n    // Optimize the case of one listener. Don't need the extra array object.\n    this._events[type] = listener;\n  else if (isObject(this._events[type]))\n    // If we've already got an array, just append.\n    this._events[type].push(listener);\n  else\n    // Adding the second element, need to change to array.\n    this._events[type] = [this._events[type], listener];\n\n  // Check for listener leak\n  if (isObject(this._events[type]) && !this._events[type].warned) {\n    if (!isUndefined(this._maxListeners)) {\n      m = this._maxListeners;\n    } else {\n      m = EventEmitter.defaultMaxListeners;\n    }\n\n    if (m && m > 0 && this._events[type].length > m) {\n      this._events[type].warned = true;\n      console.error('(node) warning: possible EventEmitter memory ' +\n                    'leak detected. %d listeners added. ' +\n                    'Use emitter.setMaxListeners() to increase limit.',\n                    this._events[type].length);\n      if (typeof console.trace === 'function') {\n        // not supported in IE 10\n        console.trace();\n      }\n    }\n  }\n\n  return this;\n};\n\nEventEmitter.prototype.on = EventEmitter.prototype.addListener;\n\nEventEmitter.prototype.once = function(type, listener) {\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  var fired = false;\n\n  function g() {\n    this.removeListener(type, g);\n\n    if (!fired) {\n      fired = true;\n      listener.apply(this, arguments);\n    }\n  }\n\n  g.listener = listener;\n  this.on(type, g);\n\n  return this;\n};\n\n// emits a 'removeListener' event iff the listener was removed\nEventEmitter.prototype.removeListener = function(type, listener) {\n  var list, position, length, i;\n\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  if (!this._events || !this._events[type])\n    return this;\n\n  list = this._events[type];\n  length = list.length;\n  position = -1;\n\n  if (list === listener ||\n      (isFunction(list.listener) && list.listener === listener)) {\n    delete this._events[type];\n    if (this._events.removeListener)\n      this.emit('removeListener', type, listener);\n\n  } else if (isObject(list)) {\n    for (i = length; i-- > 0;) {\n      if (list[i] === listener ||\n          (list[i].listener && list[i].listener === listener)) {\n        position = i;\n        break;\n      }\n    }\n\n    if (position < 0)\n      return this;\n\n    if (list.length === 1) {\n      list.length = 0;\n      delete this._events[type];\n    } else {\n      list.splice(position, 1);\n    }\n\n    if (this._events.removeListener)\n      this.emit('removeListener', type, listener);\n  }\n\n  return this;\n};\n\nEventEmitter.prototype.removeAllListeners = function(type) {\n  var key, listeners;\n\n  if (!this._events)\n    return this;\n\n  // not listening for removeListener, no need to emit\n  if (!this._events.removeListener) {\n    if (arguments.length === 0)\n      this._events = {};\n    else if (this._events[type])\n      delete this._events[type];\n    return this;\n  }\n\n  // emit removeListener for all listeners on all events\n  if (arguments.length === 0) {\n    for (key in this._events) {\n      if (key === 'removeListener') continue;\n      this.removeAllListeners(key);\n    }\n    this.removeAllListeners('removeListener');\n    this._events = {};\n    return this;\n  }\n\n  listeners = this._events[type];\n\n  if (isFunction(listeners)) {\n    this.removeListener(type, listeners);\n  } else if (listeners) {\n    // LIFO order\n    while (listeners.length)\n      this.removeListener(type, listeners[listeners.length - 1]);\n  }\n  delete this._events[type];\n\n  return this;\n};\n\nEventEmitter.prototype.listeners = function(type) {\n  var ret;\n  if (!this._events || !this._events[type])\n    ret = [];\n  else if (isFunction(this._events[type]))\n    ret = [this._events[type]];\n  else\n    ret = this._events[type].slice();\n  return ret;\n};\n\nEventEmitter.prototype.listenerCount = function(type) {\n  if (this._events) {\n    var evlistener = this._events[type];\n\n    if (isFunction(evlistener))\n      return 1;\n    else if (evlistener)\n      return evlistener.length;\n  }\n  return 0;\n};\n\nEventEmitter.listenerCount = function(emitter, type) {\n  return emitter.listenerCount(type);\n};\n\nfunction isFunction(arg) {\n  return typeof arg === 'function';\n}\n\nfunction isNumber(arg) {\n  return typeof arg === 'number';\n}\n\nfunction isObject(arg) {\n  return typeof arg === 'object' && arg !== null;\n}\n\nfunction isUndefined(arg) {\n  return arg === void 0;\n}\n","(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){\n// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\nfunction EventEmitter() {\n  this._events = this._events || {};\n  this._maxListeners = this._maxListeners || undefined;\n}\nmodule.exports = EventEmitter;\n\n// Backwards-compat with node 0.10.x\nEventEmitter.EventEmitter = EventEmitter;\n\nEventEmitter.prototype._events = undefined;\nEventEmitter.prototype._maxListeners = undefined;\n\n// By default EventEmitters will print a warning if more than 10 listeners are\n// added to it. This is a useful default which helps finding memory leaks.\nEventEmitter.defaultMaxListeners = 10;\n\n// Obviously not all Emitters should be limited to 10. This function allows\n// that to be increased. Set to zero for unlimited.\nEventEmitter.prototype.setMaxListeners = function(n) {\n  if (!isNumber(n) || n < 0 || isNaN(n))\n    throw TypeError('n must be a positive number');\n  this._maxListeners = n;\n  return this;\n};\n\nEventEmitter.prototype.emit = function(type) {\n  var er, handler, len, args, i, listeners;\n\n  if (!this._events)\n    this._events = {};\n\n  // If there is no 'error' event listener then throw.\n  if (type === 'error') {\n    if (!this._events.error ||\n        (isObject(this._events.error) && !this._events.error.length)) {\n      er = arguments[1];\n      if (er instanceof Error) {\n        throw er; // Unhandled 'error' event\n      }\n      throw TypeError('Uncaught, unspecified \"error\" event.');\n    }\n  }\n\n  handler = this._events[type];\n\n  if (isUndefined(handler))\n    return false;\n\n  if (isFunction(handler)) {\n    switch (arguments.length) {\n      // fast cases\n      case 1:\n        handler.call(this);\n        break;\n      case 2:\n        handler.call(this, arguments[1]);\n        break;\n      case 3:\n        handler.call(this, arguments[1], arguments[2]);\n        break;\n      // slower\n      default:\n        args = Array.prototype.slice.call(arguments, 1);\n        handler.apply(this, args);\n    }\n  } else if (isObject(handler)) {\n    args = Array.prototype.slice.call(arguments, 1);\n    listeners = handler.slice();\n    len = listeners.length;\n    for (i = 0; i < len; i++)\n      listeners[i].apply(this, args);\n  }\n\n  return true;\n};\n\nEventEmitter.prototype.addListener = function(type, listener) {\n  var m;\n\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  if (!this._events)\n    this._events = {};\n\n  // To avoid recursion in the case that type === \"newListener\"! Before\n  // adding it to the listeners, first emit \"newListener\".\n  if (this._events.newListener)\n    this.emit('newListener', type,\n              isFunction(listener.listener) ?\n              listener.listener : listener);\n\n  if (!this._events[type])\n    // Optimize the case of one listener. Don't need the extra array object.\n    this._events[type] = listener;\n  else if (isObject(this._events[type]))\n    // If we've already got an array, just append.\n    this._events[type].push(listener);\n  else\n    // Adding the second element, need to change to array.\n    this._events[type] = [this._events[type], listener];\n\n  // Check for listener leak\n  if (isObject(this._events[type]) && !this._events[type].warned) {\n    if (!isUndefined(this._maxListeners)) {\n      m = this._maxListeners;\n    } else {\n      m = EventEmitter.defaultMaxListeners;\n    }\n\n    if (m && m > 0 && this._events[type].length > m) {\n      this._events[type].warned = true;\n      console.error('(node) warning: possible EventEmitter memory ' +\n                    'leak detected. %d listeners added. ' +\n                    'Use emitter.setMaxListeners() to increase limit.',\n                    this._events[type].length);\n      if (typeof console.trace === 'function') {\n        // not supported in IE 10\n        console.trace();\n      }\n    }\n  }\n\n  return this;\n};\n\nEventEmitter.prototype.on = EventEmitter.prototype.addListener;\n\nEventEmitter.prototype.once = function(type, listener) {\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  var fired = false;\n\n  function g() {\n    this.removeListener(type, g);\n\n    if (!fired) {\n      fired = true;\n      listener.apply(this, arguments);\n    }\n  }\n\n  g.listener = listener;\n  this.on(type, g);\n\n  return this;\n};\n\n// emits a 'removeListener' event iff the listener was removed\nEventEmitter.prototype.removeListener = function(type, listener) {\n  var list, position, length, i;\n\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  if (!this._events || !this._events[type])\n    return this;\n\n  list = this._events[type];\n  length = list.length;\n  position = -1;\n\n  if (list === listener ||\n      (isFunction(list.listener) && list.listener === listener)) {\n    delete this._events[type];\n    if (this._events.removeListener)\n      this.emit('removeListener', type, listener);\n\n  } else if (isObject(list)) {\n    for (i = length; i-- > 0;) {\n      if (list[i] === listener ||\n          (list[i].listener && list[i].listener === listener)) {\n        position = i;\n        break;\n      }\n    }\n\n    if (position < 0)\n      return this;\n\n    if (list.length === 1) {\n      list.length = 0;\n      delete this._events[type];\n    } else {\n      list.splice(position, 1);\n    }\n\n    if (this._events.removeListener)\n      this.emit('removeListener', type, listener);\n  }\n\n  return this;\n};\n\nEventEmitter.prototype.removeAllListeners = function(type) {\n  var key, listeners;\n\n  if (!this._events)\n    return this;\n\n  // not listening for removeListener, no need to emit\n  if (!this._events.removeListener) {\n    if (arguments.length === 0)\n      this._events = {};\n    else if (this._events[type])\n      delete this._events[type];\n    return this;\n  }\n\n  // emit removeListener for all listeners on all events\n  if (arguments.length === 0) {\n    for (key in this._events) {\n      if (key === 'removeListener') continue;\n      this.removeAllListeners(key);\n    }\n    this.removeAllListeners('removeListener');\n    this._events = {};\n    return this;\n  }\n\n  listeners = this._events[type];\n\n  if (isFunction(listeners)) {\n    this.removeListener(type, listeners);\n  } else if (listeners) {\n    // LIFO order\n    while (listeners.length)\n      this.removeListener(type, listeners[listeners.length - 1]);\n  }\n  delete this._events[type];\n\n  return this;\n};\n\nEventEmitter.prototype.listeners = function(type) {\n  var ret;\n  if (!this._events || !this._events[type])\n    ret = [];\n  else if (isFunction(this._events[type]))\n    ret = [this._events[type]];\n  else\n    ret = this._events[type].slice();\n  return ret;\n};\n\nEventEmitter.prototype.listenerCount = function(type) {\n  if (this._events) {\n    var evlistener = this._events[type];\n\n    if (isFunction(evlistener))\n      return 1;\n    else if (evlistener)\n      return evlistener.length;\n  }\n  return 0;\n};\n\nEventEmitter.listenerCount = function(emitter, type) {\n  return emitter.listenerCount(type);\n};\n\nfunction isFunction(arg) {\n  return typeof arg === 'function';\n}\n\nfunction isNumber(arg) {\n  return typeof arg === 'number';\n}\n\nfunction isObject(arg) {\n  return typeof arg === 'object' && arg !== null;\n}\n\nfunction isUndefined(arg) {\n  return arg === void 0;\n}\n\n},{}],2:[function(require,module,exports){\n\"use strict\";\n\nvar _map = require(\"./map.js\");\n\nvar _map2 = _interopRequireDefault(_map);\n\nvar _overlay = require(\"./overlay.js\");\n\nvar _overlay2 = _interopRequireDefault(_overlay);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar $map = document.getElementsByClassName(\"map\")[0];\nvar mapDefaults = {\n  center: {\n    lat: 52.3942358,\n    lng: -2.2905\n  },\n  zoom: 7\n};\n\nvar map = new _map2.default({\n  el: $map,\n  defaults: mapDefaults,\n  input: document.getElementById(\"input\"),\n  countryCode: \"GB\"\n});\n\nvar overlay = new _overlay2.default(map);\n\nwindow.App = overlay;\n\n},{\"./map.js\":3,\"./overlay.js\":4}],3:[function(require,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol ? \"symbol\" : typeof obj; };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _events = require(\"events\");\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar Map = function (_EventEmitter) {\n  _inherits(Map, _EventEmitter);\n\n  function Map() {\n    _classCallCheck(this, Map);\n\n    var _this = _possibleConstructorReturn(this, Object.getPrototypeOf(Map).call(this));\n\n    var date = Date.now();\n    _this.body = document.body;\n    _this.settings = arguments[0];\n    _this.markers = {}; // stores markers\n    if (!((typeof google === \"undefined\" ? \"undefined\" : _typeof(google)) === \"object\" && google.hasOwnProperty(\"maps\"))) {\n      // if no google script\n      var script = document.createElement(\"SCRIPT\");\n      script.src = \"https://maps.googleapis.com/maps/api/js?libraries=places&callback=Map\" + date;\n      script.defer = true;\n      script.async = true;\n      _this.body.appendChild(script);\n\n      window[\"Map\" + date] = _this.initMap.bind(_this);\n    } else {\n      _this.initMap();\n    }\n    return _this;\n  }\n\n  _createClass(Map, [{\n    key: \"initMap\",\n    value: function initMap() {\n      var settings = Object.assign(this.settings.defaults, {\n        streetViewControl: false\n      });\n      //this.settings.defaults.streetViewControl = false;\n\n      this.map = new google.maps.Map(this.settings.el, settings);\n      this.geocoder = new google.maps.Geocoder();\n      this.autocomplete = new google.maps.places.Autocomplete(this.settings.input, {\n        types: [\"(cities)\"],\n        componentRestrictions: {\n          country: this.settings.countryCode\n        }\n      });\n\n      this.autocomplete.addListener(\"place_changed\", this.placeChanged.bind(this));\n      this.emit(\"loaded\");\n    }\n  }, {\n    key: \"placeChanged\",\n    value: function placeChanged() {\n      var place = this.autocomplete.getPlace();\n\n      if (place.hasOwnProperty(\"geometry\")) {\n        //this.updateMap(place);\n        this.emit(\"gotPlace\", place);\n      } else {\n        this.emit(\"error\", {\n          code: 1,\n          msg: \"No geometry property on place object\",\n          data: place\n        });\n      }\n    }\n  }, {\n    key: \"updateMap\",\n    value: function updateMap(obj) {\n\n      var bounds = {\n        north: obj.geometry.viewport.R.j,\n        east: obj.geometry.viewport.j.R,\n        south: obj.geometry.viewport.R.R,\n        west: obj.geometry.viewport.j.j\n      };\n\n      obj.bounds = bounds;\n\n      this.map.setOptions({\n        center: {\n          lat: obj.geometry.location.lat(),\n          lng: obj.geometry.location.lng()\n        },\n        zoom: 12\n      });\n\n      if (!this.hasOwnProperty(\"rectangle\")) {\n        this.rectangle = new google.maps.Rectangle({\n          bounds: bounds,\n          map: this.map,\n          fillColor: \"#000000\",\n          fillOpacity: 0,\n          strokeColor: \"#e64c4c\",\n          strokeOpacity: 0.8,\n          strokeWeight: 2\n        });\n      } else {\n        this.rectangle.setBounds(bounds);\n      }\n\n      this.emit(\"updated\", obj);\n    }\n  }, {\n    key: \"addMarkers\",\n    value: function addMarkers(obj) {\n      var key = obj.key;\n      var data = obj.data;\n\n\n      if (key === \"all\") throw \"can't use the key all\";\n      if (this.markers.hasOwnProperty(key)) throw \"already a property with the key \" + key;\n      this.markers[key] = [];\n\n      data.forEach(function (data) {\n        var lat = data.lat;\n        var lng = data.lng;\n\n        var marker = new google.maps.Marker({\n          position: {\n            lat: lat,\n            lng: lng\n          },\n          map: this.map\n        });\n\n        //icon:\"/images/location.svg\",\n        //animation:google.maps.Animation.DROP\n\n        this.markers[key].push(marker);\n      }.bind(this));\n    }\n  }, {\n    key: \"removeMarkers\",\n    value: function removeMarkers(key) {\n\n      function clearMarkers(arr) {\n        arr.forEach(function (marker) {\n          marker.setMap(null);\n        });\n      }\n\n      if (key === \"all\") {\n        for (var _key in this.markers) {\n          clearMarkers(this.markers[_key]);\n        }\n        this.markers = [];\n      } else {\n        clearMarkers(this.markers[key]);\n        //this.markers[key] = [];\n        delete this.markers[key];\n      }\n    }\n  }]);\n\n  return Map;\n}(_events.EventEmitter);\n\nexports.default = Map;\n;\n\n},{\"events\":1}],4:[function(require,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _events = require(\"events\");\n\nvar _policeApi = require(\"./police-api.js\");\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar Overlay = function (_EventEmitter) {\n  _inherits(Overlay, _EventEmitter);\n\n  function Overlay(map) {\n    _classCallCheck(this, Overlay);\n\n    var _this = _possibleConstructorReturn(this, Object.getPrototypeOf(Overlay).call(this));\n\n    _this.map = map;\n    _this.mapData = {\n      place: null,\n      poly: null\n    };\n    _this.el = {\n      $place: null,\n      $overlay: null,\n      $submit: null,\n      $year: null,\n      $month: null,\n      $policeData: null\n    };\n    _this.eventFns = {\n      click: [],\n      change: []\n    };\n    _this.possibleDates = null;\n    _this.loading = false;\n    _this.maxDate = null;\n    _this.policeData = {\n      requestEnd: null,\n      requestStart: null,\n      crimes: null\n    };\n    _this.overlay = {\n      isOpen: false,\n      requestStart: null,\n      requestEnd: null,\n      isClosing: false\n    };\n\n    (0, _policeApi.lastUpdated)(function (err, obj) {\n      if (!err) {\n        var date = obj.date.split(\"-\").slice(0, 2);\n        date = new Date(date[0], date[1] - 1);\n        this.maxDate = date.getTime();\n        this.init();\n      }\n    }.bind(_this));\n\n    return _this;\n  }\n\n  _createClass(Overlay, [{\n    key: \"generateDates\",\n    value: function generateDates() {\n\n      var possibleDates = {};\n      var currentDate = new Date(2012, 0);\n      var keys = void 0;\n      var year = void 0;\n      var month = void 0;\n      var $options = void 0;\n      var endDate = this.maxDate;\n\n      while (currentDate.getTime() < endDate) {\n        var _year = currentDate.getFullYear();\n        var _month = currentDate.getMonth() + 1; // change to 1 based\n        if (!possibleDates.hasOwnProperty(_year)) {\n          possibleDates[_year] = [];\n        }\n        possibleDates[_year].push(_month);\n        currentDate.setMonth(currentDate.getMonth() + 1);\n      }\n\n      keys = Object.keys(possibleDates);\n      year = keys[keys.length - 1];\n      month = possibleDates[year];\n      month = month[month.length - 1];\n\n      this.el.$year.innerHTML = keys.map(function (key) {\n        return \"<option value=\\\"\" + key + \"\\\">\" + key + \"</option>\";\n      }).join(\"\");\n\n      $options = this.el.$year.getElementsByTagName(\"option\");\n      this.el.$year.value = $options[$options.length - 1].value;\n      this.possibleDates = possibleDates;\n      this.setMonths(year, month);\n      this.currentDate = year + \"-\" + month;\n    }\n  }, {\n    key: \"setMonths\",\n    value: function setMonths(year, monthToSelect) {\n      var months = this.possibleDates[year];\n\n      this.el.$month.innerHTML = months.map(function (key) {\n        return \"<option value=\\\"\" + key + \"\\\">\" + key + \"</option>\";\n      }).join(\"\");\n\n      if (monthToSelect) {\n        var i = monthToSelect;\n        if (!months[monthToSelect - 1]) {\n          i = 1;\n        }\n        var $months = this.el.$month.getElementsByTagName(\"option\");\n        this.el.$month.value = i;\n      }\n    }\n  }, {\n    key: \"gotPlace\",\n    value: function gotPlace(place) {\n      this.mapData.place = place;\n      this.mapData.poly = this.createPoly(place.geometry.viewport.R.j, place.geometry.viewport.j.R, place.geometry.viewport.R.R, place.geometry.viewport.j.j);\n    }\n  }, {\n    key: \"mapError\",\n    value: function mapError() {\n      console.log(arguments);\n    }\n  }, {\n    key: \"policeDataFn\",\n    value: function policeDataFn(err, res) {\n      var _this3 = this;\n\n      function changeData(str) {\n        var _this2 = this;\n\n        this.el.$policeData.innerHTML = str;\n        setTimeout(function () {\n          // allows opacity transition to work corretly\n          _this2.el.$policeData.classList.add(\"map-overlay__police-data--show\");\n          _this2.overlay.isOpen = true;\n        }, 0);\n      }\n\n      if (err || res.hasOwnProperty(\"status\")) {\n        //    this.emit(\"error\", err)\n        //this.emit(\"popup\",\"\");\n      } else {\n          (function () {\n            var crimes = {};\n            var str = \"\";\n            var requestDiff = void 0;\n\n            _this3.policeData.requestEnd = Date.now();\n\n            res.forEach(function (data) {\n              var category = data.category.replace(/-/g, \" \").split(\" \").map(function (text) {\n                return text.charAt(0).toUpperCase() + text.substr(1);\n              }).join(\" \");\n\n              if (!crimes.hasOwnProperty(category)) {\n                crimes[category] = [];\n              }\n              crimes[category].push(data);\n            });\n\n            for (var key in crimes) {\n              str += \"<div class='map-overlay__police-data__section' data-category=\\\"\" + key + \"\\\">\" + crimes[key].length + \" x \" + key + \"</div>\";\n            }\n            str += \"<p class=\\\"map-overlay__police-data__total\\\">Total: \" + res.length + \"</p>\";\n\n            requestDiff = _this3.policeData.requestEnd - _this3.policeData.requestStart;\n            _this3.policeData.crimes = crimes;\n\n            //  if (requestDiff < 1000) {\n            //  setTimeout(() => {\n            if (_this3.overlay.isClosing === false) {\n              changeData.call(_this3, [str]);\n            } else {\n              _this3.once(\"OVERLAY-CLOSED\", function () {\n                changeData.call(this, [str]);\n              });\n            }\n          })();\n        }\n    }\n  }, {\n    key: \"createPoly\",\n    value: function createPoly(north, east, south, west) {\n      var poly = north + \",\" + east + \":\" + south + \",\" + east + \":\" + south + \",\" + west + \":\" + north + \",\" + west;\n      return poly;\n    }\n  }, {\n    key: \"submitClick\",\n    value: function submitClick() {\n      if (this.el.$place.value.trim() === \"\") {\n        console.log(\"PLEASE SELECT A PLACE\");\n      } else {\n        var formattedDate = this.el.$year.value + \"-\" + this.el.$month.value;\n        this.map.updateMap(this.mapData.place);\n        this.loading = true;\n        this.policeData.requestStart = Date.now();\n\n        if (this.overlay.isOpen) {\n          this.closeOverlay();\n        }\n\n        (0, _policeApi.getData)({\n          poly: this.mapData.poly,\n          date: formattedDate,\n          callback: this.policeDataFn.bind(this)\n        });\n      }\n    }\n  }, {\n    key: \"closeOverlay\",\n    value: function closeOverlay() {\n      var _this4 = this;\n\n      this.map.removeMarkers(\"all\");\n      this.overlay.isClosing = true;\n      this.el.$policeData.classList.add(\"map-overlay__police-data--closing\");\n      this.el.$policeData.style.transitionDelay = \"0.1s\";\n      setTimeout(function () {\n        _this4.el.$policeData.classList.remove(\"map-overlay__police-data--show\");\n      }, 0);\n\n      setTimeout(function () {\n        _this4.el.$policeData.style.transitionDelay = null;\n        _this4.el.$policeData.classList.remove(\"map-overlay__police-data--closing\");\n\n        setTimeout(function () {\n          _this4.overlay.isOpen = false;\n          _this4.overlay.isClosing = false;\n          _this4.emit(\"OVERLAY-CLOSED\");\n        }, 400);\n      }, 100);\n    }\n  }, {\n    key: \"dataClick\",\n    value: function dataClick(target) {\n      var key = target.getAttribute(\"data-category\");\n      if (target.classList.contains(\"map-overlay__police-data__section--active\")) {\n        // remove markers\n        target.classList.remove(\"map-overlay__police-data__section--active\");\n        this.map.removeMarkers(key);\n      } else {\n        // add markers\n        var crimes = this.policeData.crimes[key].map(function (obj) {\n          return {\n            lat: parseFloat(obj.location.latitude),\n            lng: parseFloat(obj.location.longitude)\n          };\n        });\n        target.classList.add(\"map-overlay__police-data__section--active\");\n        this.map.addMarkers({\n          key: key,\n          data: crimes\n        });\n      }\n    }\n  }, {\n    key: \"yearChange\",\n    value: function yearChange() {\n      var year = this.el.$year.value;\n      var month = this.el.$month.value;\n      this.setMonths(year, month);\n    }\n\n    // one main eventHandler function\n\n  }, {\n    key: \"eventHandler\",\n    value: function eventHandler(root, e) {\n      var target = e.target;\n\n      var oTarget = target;\n      var fns = this.eventFns[e.type];\n      var _ = this;\n\n      if (Array.isArray(fns)) {\n        fns.forEach(function (obj) {\n          var found = false;\n          target = oTarget;\n\n          while (!found && !target.isSameNode(root)) {\n\n            if (typeof obj.el === \"string\") {\n\n              if (target.classList.contains(obj.el)) {\n                found = true;\n              } else {\n                target = target.parentElement;\n              }\n            } else {\n              if (target.isSameNode(obj.el)) {\n                found = true;\n              } else {\n                target = target.parentElement;\n              }\n            }\n          }\n\n          if (found) {\n            obj.fn.call(_, target);\n          }\n        });\n      }\n    }\n  }, {\n    key: \"init\",\n    value: function init() {\n      this.el.$overlay = document.getElementsByClassName(\"map-overlay\")[0];\n      this.el.$submit = this.el.$overlay.getElementsByClassName(\"map-overlay__button\")[0];\n      this.el.$place = this.el.$overlay.getElementsByClassName(\"map-overlay__input\")[0];\n      this.el.$year = this.el.$overlay.getElementsByClassName(\"map-overlay__year-select\")[0];\n      this.el.$month = this.el.$overlay.getElementsByClassName(\"map-overlay__month-select\")[0];\n      this.el.$policeData = this.el.$overlay.getElementsByClassName(\"map-overlay__police-data\")[0];\n\n      this.generateDates();\n\n      this.map.on(\"gotPlace\", this.gotPlace.bind(this)).on(\"error\", this.mapError.bind(this));\n\n      // trying something new with event handlers - don't hate\n      this.el.$overlay.addEventListener(\"click\", this.eventHandler.bind(this, this.el.$overlay));\n      this.el.$overlay.addEventListener(\"change\", this.eventHandler.bind(this, this.el.$overlay));\n\n      this.eventFns.change.push({\n        el: this.el.$year,\n        fn: this.yearChange\n      });\n\n      this.eventFns.click.push({\n        el: this.el.$submit,\n        fn: this.submitClick\n      });\n\n      this.eventFns.click.push({\n        el: \"map-overlay__police-data__section\",\n        fn: this.dataClick\n      });\n\n      this.el.$overlay.classList.add(\"map-overlay--show\");\n    }\n  }]);\n\n  return Overlay;\n}(_events.EventEmitter);\n\nexports.default = Overlay;\n\n},{\"./police-api.js\":5,\"events\":1}],5:[function(require,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.getData = getData;\nexports.lastUpdated = lastUpdated;\nvar endpoint = \"https://data.police.uk/api/crimes-street/all-crime\";\n\nfunction getData(obj) {\n  var date = obj.date;\n  var poly = obj.poly;\n  var callback = obj.callback;\n\n\n  fetch(endpoint + (\"?poly=\" + poly + \"&date=\" + date)).then(function (res) {\n    if (res.status === 200) {\n      return res.json();\n    } else {\n      return {\n        status: res.status,\n        statusText: res.statusText\n      };\n    }\n  }).then(function (data) {\n    callback(null, data);\n  }).catch(function (err) {\n    callback(err);\n  });\n}\n\nfunction lastUpdated(callback) {\n\n  fetch(\"https://data.police.uk/api/crime-last-updated\").then(function (res) {\n    return res.json();\n  }).then(function (data) {\n    callback(null, data);\n  }).catch(function (err) {\n    callback(err);\n  });\n}\n\n},{}]},{},[2])\n\n","import Map from \"./map.js\";\r\nimport Overlay from  \"./overlay.js\";\r\n\r\nconst $map = document.getElementsByClassName(\"map\")[0];\r\nconst mapDefaults = {\r\n  center: {\r\n    lat: 52.3942358,\r\n    lng: -2.2905\r\n  },\r\n  zoom: 7\r\n};\r\n\r\nconst map = new Map({\r\n  el:$map,\r\n  defaults:mapDefaults,\r\n  input:document.getElementById(\"input\"),\r\n  countryCode:\"GB\"\r\n});\r\n\r\nconst overlay = new Overlay(map);\r\n\r\nwindow.App = overlay;\r\n","import {\r\n  EventEmitter\r\n} from \"events\";\r\n\r\nexport default class Map extends EventEmitter {\r\n  constructor() {\r\n    super();\r\n    const date = Date.now();\r\n    this.body = document.body;\r\n    this.settings = arguments[0];\r\n    this.markers = {}; // stores markers\r\n    if (!(typeof google === \"object\" && google.hasOwnProperty(\"maps\"))) { // if no google script\r\n      const script = document.createElement(\"SCRIPT\");\r\n      script.src = \"https://maps.googleapis.com/maps/api/js?libraries=places&callback=Map\" + date;\r\n      script.defer = true;\r\n      script.async = true;\r\n      this.body.appendChild(script);\r\n\r\n      window[\"Map\" + date] = this.initMap.bind(this);\r\n    } else {\r\n      this.initMap();\r\n    }\r\n  }\r\n\r\n  initMap() {\r\n      let settings = Object.assign(this.settings.defaults, {\r\n      streetViewControl:false,\r\n    });\r\n    //this.settings.defaults.streetViewControl = false;\r\n\r\n    this.map = new google.maps.Map(this.settings.el, settings);\r\n    this.geocoder = new google.maps.Geocoder();\r\n    this.autocomplete = new google.maps.places.Autocomplete(this.settings.input, {\r\n      types: [\"(cities)\"],\r\n      componentRestrictions: {\r\n        country: this.settings.countryCode\r\n      }\r\n    });\r\n\r\n    this.autocomplete.addListener(\"place_changed\", this.placeChanged.bind(this));\r\n    this.emit(\"loaded\");\r\n  }\r\n\r\n\r\n  placeChanged() {\r\n    const place = this.autocomplete.getPlace();\r\n\r\n    if (place.hasOwnProperty(\"geometry\")) {\r\n      //this.updateMap(place);\r\n      this.emit(\"gotPlace\", place);\r\n    } else {\r\n      this.emit(\"error\", {\r\n        code: 1,\r\n        msg: \"No geometry property on place object\",\r\n        data:place\r\n      });\r\n    }\r\n  }\r\n\r\n\r\n  updateMap(obj) {\r\n\r\n    const bounds = {\r\n      north: obj.geometry.viewport.R.j,\r\n      east: obj.geometry.viewport.j.R,\r\n      south: obj.geometry.viewport.R.R,\r\n      west: obj.geometry.viewport.j.j\r\n    };\r\n\r\n    obj.bounds = bounds;\r\n\r\n    this.map.setOptions({\r\n      center: {\r\n        lat: obj.geometry.location.lat(),\r\n        lng: obj.geometry.location.lng()\r\n      },\r\n      zoom: 12\r\n    });\r\n\r\n    if (!this.hasOwnProperty(\"rectangle\")) {\r\n      this.rectangle = new google.maps.Rectangle({\r\n        bounds,\r\n        map: this.map,\r\n        fillColor: \"#000000\",\r\n        fillOpacity: 0,\r\n        strokeColor: \"#e64c4c\",\r\n        strokeOpacity: 0.8,\r\n        strokeWeight: 2\r\n      });\r\n\r\n    } else {\r\n      this.rectangle.setBounds(bounds);\r\n    }\r\n\r\n    this.emit(\"updated\", obj);\r\n  }\r\n\r\n  addMarkers(obj) {\r\n    const {\r\n      key,\r\n      data\r\n    } = obj;\r\n\r\n    if (key === \"all\") throw \"can't use the key all\";\r\n    if (this.markers.hasOwnProperty(key)) throw \"already a property with the key \" + key;\r\n    this.markers[key] = [];\r\n\r\n    data.forEach(function(data) {\r\n      const {\r\n        lat,\r\n        lng\r\n      } = data;\r\n      const  marker = new google.maps.Marker({\r\n        position:{\r\n          lat,\r\n          lng\r\n        },\r\n        map: this.map,\r\n        //icon:\"/images/location.svg\",\r\n        //animation:google.maps.Animation.DROP\r\n\r\n      });\r\n\r\n      this.markers[key].push(marker);\r\n\r\n    }.bind(this));\r\n  }\r\n\r\n  removeMarkers(key) {\r\n\r\n    function clearMarkers(arr) {\r\n      arr.forEach(function(marker) {\r\n        marker.setMap(null);\r\n      });\r\n    }\r\n\r\n    if(key === \"all\"){\r\n      for (let key in this.markers){\r\n        clearMarkers(this.markers[key]);\r\n      }\r\n      this.markers = [];\r\n    }\r\n    else{\r\n      clearMarkers(this.markers[key]);\r\n      //this.markers[key] = [];\r\n      delete this.markers[key];\r\n    }\r\n\r\n  }\r\n\r\n};\r\n","import {\r\n  EventEmitter\r\n} from \"events\";\r\nimport {\r\n  getData,\r\n  lastUpdated\r\n} from \"./police-api.js\";\r\n\r\nexport default class Overlay extends EventEmitter {\r\n  constructor(map) {\r\n\r\n    super();\r\n    this.map = map;\r\n    this.mapData = {\r\n      place: null,\r\n      poly:null\r\n    };\r\n    this.el = {\r\n      $place:null,\r\n      $overlay: null,\r\n      $submit: null,\r\n      $year: null,\r\n      $month: null,\r\n      $policeData:null\r\n    }\r\n    this.eventFns = {\r\n      click: [],\r\n      change: []\r\n    }\r\n    this.possibleDates = null;\r\n    this.loading = false;\r\n    this.maxDate = null;\r\n    this.policeData = {\r\n      requestEnd:null,\r\n      requestStart:null,\r\n      crimes:null\r\n    }\r\n    this.overlay = {\r\n      isOpen:false,\r\n      requestStart:null,\r\n      requestEnd:null,\r\n      isClosing:false\r\n    };\r\n\r\n    lastUpdated(function(err, obj) {\r\n      if (!err) {\r\n        let date = obj.date.split(\"-\").slice(0, 2);\r\n        date = new Date(date[0], date[1] - 1);\r\n        this.maxDate = date.getTime();\r\n        this.init();\r\n      }\r\n    }.bind(this));\r\n\r\n  }\r\n\r\n\r\n\r\n  generateDates() {\r\n\r\n    let possibleDates = {};\r\n    let currentDate = new Date(2012, 0);\r\n    let keys;\r\n    let year;\r\n    let month;\r\n    let $options;\r\n    const endDate = this.maxDate;\r\n\r\n    while (currentDate.getTime() < endDate) {\r\n      const year = currentDate.getFullYear();\r\n      const month = currentDate.getMonth() + 1; // change to 1 based\r\n      if (!possibleDates.hasOwnProperty(year)) {\r\n        possibleDates[year] = [];\r\n      }\r\n      possibleDates[year].push(month);\r\n      currentDate.setMonth(currentDate.getMonth() + 1);\r\n    }\r\n\r\n    keys = Object.keys(possibleDates);\r\n    year = keys[keys.length - 1];\r\n    month = possibleDates[year];\r\n    month = month[month.length - 1];\r\n\r\n\r\n    this.el.$year.innerHTML = keys.map(function(key) {\r\n      return `<option value=\"${key}\">${key}</option>`;\r\n    }).join(\"\");\r\n\r\n    $options = this.el.$year.getElementsByTagName(\"option\");\r\n    this.el.$year.value = $options[$options.length - 1].value;\r\n    this.possibleDates = possibleDates;\r\n    this.setMonths(year, month);\r\n    this.currentDate = year + \"-\" + month;\r\n  }\r\n\r\n  setMonths(year, monthToSelect) {\r\n    const months = this.possibleDates[year];\r\n\r\n    this.el.$month.innerHTML = months.map(function(key) {\r\n      return `<option value=\"${key}\">${key}</option>`;\r\n    }).join(\"\");\r\n\r\n\r\n    if (monthToSelect) {\r\n      let i = monthToSelect;\r\n      if (!months[monthToSelect - 1]) {\r\n        i = 1;\r\n      }\r\n      const $months = this.el.$month.getElementsByTagName(\"option\");\r\n      this.el.$month.value = i;\r\n    }\r\n\r\n  }\r\n\r\n\r\n\r\n  gotPlace(place) {\r\n    this.mapData.place = place;\r\n    this.mapData.poly = this.createPoly(place.geometry.viewport.R.j,place.geometry.viewport.j.R,place.geometry.viewport.R.R,place.geometry.viewport.j.j);\r\n  }\r\n\r\n  mapError() {\r\n    console.log(arguments);\r\n  }\r\n\r\n  policeDataFn(err, res){\r\n    function changeData(str) {\r\n\r\n      this.el.$policeData.innerHTML = str;\r\n      setTimeout(() => { // allows opacity transition to work corretly\r\n        this.el.$policeData.classList.add(\"map-overlay__police-data--show\");\r\n        this.overlay.isOpen = true;\r\n      }, 0);\r\n    }\r\n\r\n\r\n    if (err || res.hasOwnProperty(\"status\")) {\r\n      //    this.emit(\"error\", err)\r\n      //this.emit(\"popup\",\"\");\r\n    } else {\r\n      let crimes = {};\r\n      let str = \"\";\r\n      let requestDiff;\r\n\r\n      this.policeData.requestEnd = Date.now();\r\n\r\n      res.forEach(function(data) {\r\n        let category = data.category.replace(/-/g, \" \")\r\n          .split(\" \").map(function(text) {\r\n            return text.charAt(0).toUpperCase() + text.substr(1);\r\n          }).join(\" \");\r\n\r\n        if (!crimes.hasOwnProperty(category)) {\r\n          crimes[category] = [];\r\n        }\r\n        crimes[category].push(data);\r\n      });\r\n\r\n\r\n      for (let key in crimes) {\r\n        str += `<div class='map-overlay__police-data__section' data-category=\"${key}\">${crimes[key].length} x ${key}</div>`;\r\n      }\r\n      str += `<p class=\"map-overlay__police-data__total\">Total: ${res.length}</p>`\r\n\r\n      requestDiff = this.policeData.requestEnd - this.policeData.requestStart;\r\n      this.policeData.crimes = crimes;\r\n\r\n    //  if (requestDiff < 1000) {\r\n      //  setTimeout(() => {\r\n      if(this.overlay.isClosing === false){\r\n        changeData.call(this, [str]);\r\n      }\r\n      else{\r\n        this.once(\"OVERLAY-CLOSED\", function() {\r\n          changeData.call(this, [str]);\r\n        });\r\n      }\r\n\r\n    }\r\n  }\r\n\r\n   createPoly(north, east, south, west) {\r\n    const poly = `${north},${east}:${south},${east}:${south},${west}:${north},${west}`;\r\n    return poly;\r\n  }\r\n\r\n  submitClick() {\r\n    if (this.el.$place.value.trim() === \"\") {\r\n      console.log(\"PLEASE SELECT A PLACE\");\r\n    } else {\r\n      const formattedDate = this.el.$year.value + \"-\" + this.el.$month.value;\r\n      this.map.updateMap(this.mapData.place);\r\n      this.loading = true;\r\n      this.policeData.requestStart = Date.now();\r\n\r\n      if(this.overlay.isOpen){\r\n        this.closeOverlay();\r\n      }\r\n\r\n\r\n      getData({\r\n        poly:this.mapData.poly,\r\n        date:formattedDate,\r\n        callback:this.policeDataFn.bind(this)\r\n      });\r\n\r\n    }\r\n  }\r\n\r\n  closeOverlay(){\r\n    this.map.removeMarkers(\"all\");\r\n    this.overlay.isClosing = true;\r\n    this.el.$policeData.classList.add(\"map-overlay__police-data--closing\");\r\n    this.el.$policeData.style.transitionDelay = \"0.1s\";\r\n    setTimeout(()=> {\r\n      this.el.$policeData.classList.remove(\"map-overlay__police-data--show\");\r\n    },0);\r\n\r\n    setTimeout(()=> {\r\n        this.el.$policeData.style.transitionDelay = null;\r\n        this.el.$policeData.classList.remove(\"map-overlay__police-data--closing\");\r\n\r\n        setTimeout(()=>{\r\n          this.overlay.isOpen = false;\r\n          this.overlay.isClosing = false;\r\n          this.emit(\"OVERLAY-CLOSED\");\r\n\r\n        },400);\r\n\r\n    },100);\r\n\r\n  }\r\n\r\n  dataClick(target){\r\n    let key = target.getAttribute(\"data-category\");\r\n    if (target.classList.contains(\"map-overlay__police-data__section--active\")) { // remove markers\r\n      target.classList.remove(\"map-overlay__police-data__section--active\");\r\n      this.map.removeMarkers(key);\r\n    } else { // add markers\r\n      let crimes = this.policeData.crimes[key].map(function(obj) {\r\n        return {\r\n          lat: parseFloat(obj.location.latitude),\r\n          lng: parseFloat(obj.location.longitude)\r\n        };\r\n      });\r\n      target.classList.add(\"map-overlay__police-data__section--active\");\r\n      this.map.addMarkers({\r\n        key,\r\n        data: crimes\r\n      });\r\n    }\r\n  }\r\n\r\n  yearChange() {\r\n    const year = this.el.$year.value;\r\n    const month = this.el.$month.value\r\n    this.setMonths(year, month);\r\n  }\r\n\r\n  // one main eventHandler function\r\n  eventHandler(root, e) {\r\n\r\n    let {\r\n      target\r\n    } = e;\r\n    const oTarget = target;\r\n    const fns = this.eventFns[e.type];\r\n    const _ = this;\r\n\r\n    if (Array.isArray(fns)) {\r\n      fns.forEach(function(obj) {\r\n        let found = false;\r\n        target = oTarget;\r\n\r\n        while (!found && !target.isSameNode(root)) {\r\n\r\n          if(typeof obj.el === \"string\"){\r\n\r\n            if(target.classList.contains(obj.el)){\r\n              found = true;\r\n            }\r\n            else{\r\n              target = target.parentElement;\r\n            }\r\n          }\r\n          else{\r\n            if (target.isSameNode(obj.el)) {\r\n              found = true;\r\n            } else {\r\n              target = target.parentElement;\r\n            }\r\n          }\r\n\r\n        }\r\n\r\n\r\n        if (found) {\r\n          obj.fn.call(_, target);\r\n        }\r\n      });\r\n    }\r\n\r\n\r\n  }\r\n\r\n  init() {\r\n    this.el.$overlay = document.getElementsByClassName(\"map-overlay\")[0];\r\n    this.el.$submit = this.el.$overlay.getElementsByClassName(\"map-overlay__button\")[0];\r\n    this.el.$place = this.el.$overlay.getElementsByClassName(\"map-overlay__input\")[0];\r\n    this.el.$year = this.el.$overlay.getElementsByClassName(\"map-overlay__year-select\")[0];\r\n    this.el.$month = this.el.$overlay.getElementsByClassName(\"map-overlay__month-select\")[0];\r\n    this.el.$policeData = this.el.$overlay.getElementsByClassName(\"map-overlay__police-data\")[0];\r\n\r\n    this.generateDates();\r\n\r\n    this.map\r\n      .on(\"gotPlace\", this.gotPlace.bind(this))\r\n      .on(\"error\", this.mapError.bind(this));\r\n\r\n    // trying something new with event handlers - don't hate\r\n    this.el.$overlay.addEventListener(\"click\", this.eventHandler.bind(this, this.el.$overlay));\r\n    this.el.$overlay.addEventListener(\"change\", this.eventHandler.bind(this, this.el.$overlay));\r\n\r\n    this.eventFns.change.push({\r\n      el: this.el.$year,\r\n      fn: this.yearChange\r\n    });\r\n\r\n    this.eventFns.click.push({\r\n      el: this.el.$submit,\r\n      fn: this.submitClick\r\n    });\r\n\r\n    this.eventFns.click.push({\r\n      el:\"map-overlay__police-data__section\",\r\n      fn:this.dataClick\r\n    })\r\n\r\n    this.el.$overlay.classList.add(\"map-overlay--show\");\r\n  }\r\n\r\n\r\n\r\n}\r\n","const endpoint = \"https://data.police.uk/api/crimes-street/all-crime\";\r\n\r\nexport function getData(obj) {\r\n  const { date, poly, callback } = obj;\r\n\r\n  fetch(endpoint +`?poly=${poly}&date=${date}`)\r\n  .then(function(res) {\r\n    if(res.status === 200){\r\n      return res.json();\r\n    }\r\n    else{\r\n      return {\r\n        status:res.status,\r\n        statusText:res.statusText\r\n      }\r\n    }\r\n  })\r\n  .then(function(data) {\r\n    callback(null, data);\r\n  })\r\n  .catch(function(err) {\r\n    callback(err);\r\n  });\r\n}\r\n\r\nexport function lastUpdated(callback){\r\n\r\n  fetch(\"https://data.police.uk/api/crime-last-updated\")\r\n  .then(function(res) {\r\n    return res.json();\r\n  })\r\n  .then(function(data) {\r\n    callback(null, data);\r\n  })\r\n  .catch(function(err) {\r\n    callback(err);\r\n  });\r\n\r\n}\r\n"],"sourceRoot":"/"}