{"version":3,"sources":["node_modules/browser-pack/_prelude.js","node_modules/events/events.js","main.js","src/js/main.js","src/js/map.js","src/js/overlay.js","src/js/police-api.js"],"names":["e","t","n","r","s","o","u","a","require","i","f","Error","code","l","exports","call","length",1,"module","EventEmitter","this","_events","_maxListeners","undefined","isFunction","arg","isNumber","isObject","isUndefined","prototype","defaultMaxListeners","setMaxListeners","isNaN","TypeError","emit","type","er","handler","len","args","listeners","error","arguments","Array","slice","apply","addListener","listener","m","newListener","push","warned","console","trace","on","once","g","removeListener","fired","list","position","splice","removeAllListeners","key","ret","listenerCount","evlistener","emitter",2,"_interopRequireDefault","obj","__esModule","default","_map","_map2","_overlay","_overlay2","$map","document","getElementsByClassName","mapDefaults","center","lat","lng","zoom","map","el","defaults","input","getElementById","countryCode","./map.js","./overlay.js",3,"_classCallCheck","instance","Constructor","_possibleConstructorReturn","self","ReferenceError","_inherits","subClass","superClass","Object","create","constructor","value","enumerable","writable","configurable","setPrototypeOf","__proto__","defineProperty","_typeof","Symbol","iterator","_createClass","defineProperties","target","props","descriptor","protoProps","staticProps","Map","_EventEmitter","_this","getPrototypeOf","date","Date","now","body","settings","markers","google","hasOwnProperty","initMap","script","createElement","src","defer","async","appendChild","window","bind","assign","streetViewControl","maps","geocoder","Geocoder","autocomplete","places","Autocomplete","types","componentRestrictions","country","placeChanged","place","getPlace","msg","data","bounds","north","geometry","viewport","R","j","east","south","west","setOptions","location","rectangle","setBounds","Rectangle","fillColor","fillOpacity","strokeColor","strokeOpacity","strokeWeight","forEach","marker","Marker","clearMarkers","arr","setMap","_key","events",4,"_policeApi","Overlay","mapData","poly","$place","$overlay","$submit","$year","$month","$policeData","eventFns","click","change","possibleDates","loading","maxDate","policeData","requestEnd","requestStart","crimes","lastUpdated","err","split","getTime","init","currentDate","keys","year","month","$options","endDate","_year","getFullYear","_month","getMonth","setMonth","innerHTML","join","getElementsByTagName","setMonths","monthToSelect","months","createPoly","log","res","changeData","str","_this2","setTimeout","classList","add","_this3","requestDiff","category","replace","text","charAt","toUpperCase","substr","trim","formattedDate","updateMap","getData","callback","policeDataFn","getAttribute","contains","remove","removeMarkers","parseFloat","latitude","longitude","addMarkers","root","oTarget","fns","_","isArray","found","isSameNode","parentElement","fn","generateDates","gotPlace","mapError","addEventListener","eventHandler","yearChange","submitClick","dataClick","./police-api.js",5,"fetch","endpoint","then","json"],"mappings":"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","file":"main.min.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\nfunction EventEmitter() {\n  this._events = this._events || {};\n  this._maxListeners = this._maxListeners || undefined;\n}\nmodule.exports = EventEmitter;\n\n// Backwards-compat with node 0.10.x\nEventEmitter.EventEmitter = EventEmitter;\n\nEventEmitter.prototype._events = undefined;\nEventEmitter.prototype._maxListeners = undefined;\n\n// By default EventEmitters will print a warning if more than 10 listeners are\n// added to it. This is a useful default which helps finding memory leaks.\nEventEmitter.defaultMaxListeners = 10;\n\n// Obviously not all Emitters should be limited to 10. This function allows\n// that to be increased. Set to zero for unlimited.\nEventEmitter.prototype.setMaxListeners = function(n) {\n  if (!isNumber(n) || n < 0 || isNaN(n))\n    throw TypeError('n must be a positive number');\n  this._maxListeners = n;\n  return this;\n};\n\nEventEmitter.prototype.emit = function(type) {\n  var er, handler, len, args, i, listeners;\n\n  if (!this._events)\n    this._events = {};\n\n  // If there is no 'error' event listener then throw.\n  if (type === 'error') {\n    if (!this._events.error ||\n        (isObject(this._events.error) && !this._events.error.length)) {\n      er = arguments[1];\n      if (er instanceof Error) {\n        throw er; // Unhandled 'error' event\n      }\n      throw TypeError('Uncaught, unspecified \"error\" event.');\n    }\n  }\n\n  handler = this._events[type];\n\n  if (isUndefined(handler))\n    return false;\n\n  if (isFunction(handler)) {\n    switch (arguments.length) {\n      // fast cases\n      case 1:\n        handler.call(this);\n        break;\n      case 2:\n        handler.call(this, arguments[1]);\n        break;\n      case 3:\n        handler.call(this, arguments[1], arguments[2]);\n        break;\n      // slower\n      default:\n        args = Array.prototype.slice.call(arguments, 1);\n        handler.apply(this, args);\n    }\n  } else if (isObject(handler)) {\n    args = Array.prototype.slice.call(arguments, 1);\n    listeners = handler.slice();\n    len = listeners.length;\n    for (i = 0; i < len; i++)\n      listeners[i].apply(this, args);\n  }\n\n  return true;\n};\n\nEventEmitter.prototype.addListener = function(type, listener) {\n  var m;\n\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  if (!this._events)\n    this._events = {};\n\n  // To avoid recursion in the case that type === \"newListener\"! Before\n  // adding it to the listeners, first emit \"newListener\".\n  if (this._events.newListener)\n    this.emit('newListener', type,\n              isFunction(listener.listener) ?\n              listener.listener : listener);\n\n  if (!this._events[type])\n    // Optimize the case of one listener. Don't need the extra array object.\n    this._events[type] = listener;\n  else if (isObject(this._events[type]))\n    // If we've already got an array, just append.\n    this._events[type].push(listener);\n  else\n    // Adding the second element, need to change to array.\n    this._events[type] = [this._events[type], listener];\n\n  // Check for listener leak\n  if (isObject(this._events[type]) && !this._events[type].warned) {\n    if (!isUndefined(this._maxListeners)) {\n      m = this._maxListeners;\n    } else {\n      m = EventEmitter.defaultMaxListeners;\n    }\n\n    if (m && m > 0 && this._events[type].length > m) {\n      this._events[type].warned = true;\n      console.error('(node) warning: possible EventEmitter memory ' +\n                    'leak detected. %d listeners added. ' +\n                    'Use emitter.setMaxListeners() to increase limit.',\n                    this._events[type].length);\n      if (typeof console.trace === 'function') {\n        // not supported in IE 10\n        console.trace();\n      }\n    }\n  }\n\n  return this;\n};\n\nEventEmitter.prototype.on = EventEmitter.prototype.addListener;\n\nEventEmitter.prototype.once = function(type, listener) {\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  var fired = false;\n\n  function g() {\n    this.removeListener(type, g);\n\n    if (!fired) {\n      fired = true;\n      listener.apply(this, arguments);\n    }\n  }\n\n  g.listener = listener;\n  this.on(type, g);\n\n  return this;\n};\n\n// emits a 'removeListener' event iff the listener was removed\nEventEmitter.prototype.removeListener = function(type, listener) {\n  var list, position, length, i;\n\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  if (!this._events || !this._events[type])\n    return this;\n\n  list = this._events[type];\n  length = list.length;\n  position = -1;\n\n  if (list === listener ||\n      (isFunction(list.listener) && list.listener === listener)) {\n    delete this._events[type];\n    if (this._events.removeListener)\n      this.emit('removeListener', type, listener);\n\n  } else if (isObject(list)) {\n    for (i = length; i-- > 0;) {\n      if (list[i] === listener ||\n          (list[i].listener && list[i].listener === listener)) {\n        position = i;\n        break;\n      }\n    }\n\n    if (position < 0)\n      return this;\n\n    if (list.length === 1) {\n      list.length = 0;\n      delete this._events[type];\n    } else {\n      list.splice(position, 1);\n    }\n\n    if (this._events.removeListener)\n      this.emit('removeListener', type, listener);\n  }\n\n  return this;\n};\n\nEventEmitter.prototype.removeAllListeners = function(type) {\n  var key, listeners;\n\n  if (!this._events)\n    return this;\n\n  // not listening for removeListener, no need to emit\n  if (!this._events.removeListener) {\n    if (arguments.length === 0)\n      this._events = {};\n    else if (this._events[type])\n      delete this._events[type];\n    return this;\n  }\n\n  // emit removeListener for all listeners on all events\n  if (arguments.length === 0) {\n    for (key in this._events) {\n      if (key === 'removeListener') continue;\n      this.removeAllListeners(key);\n    }\n    this.removeAllListeners('removeListener');\n    this._events = {};\n    return this;\n  }\n\n  listeners = this._events[type];\n\n  if (isFunction(listeners)) {\n    this.removeListener(type, listeners);\n  } else if (listeners) {\n    // LIFO order\n    while (listeners.length)\n      this.removeListener(type, listeners[listeners.length - 1]);\n  }\n  delete this._events[type];\n\n  return this;\n};\n\nEventEmitter.prototype.listeners = function(type) {\n  var ret;\n  if (!this._events || !this._events[type])\n    ret = [];\n  else if (isFunction(this._events[type]))\n    ret = [this._events[type]];\n  else\n    ret = this._events[type].slice();\n  return ret;\n};\n\nEventEmitter.prototype.listenerCount = function(type) {\n  if (this._events) {\n    var evlistener = this._events[type];\n\n    if (isFunction(evlistener))\n      return 1;\n    else if (evlistener)\n      return evlistener.length;\n  }\n  return 0;\n};\n\nEventEmitter.listenerCount = function(emitter, type) {\n  return emitter.listenerCount(type);\n};\n\nfunction isFunction(arg) {\n  return typeof arg === 'function';\n}\n\nfunction isNumber(arg) {\n  return typeof arg === 'number';\n}\n\nfunction isObject(arg) {\n  return typeof arg === 'object' && arg !== null;\n}\n\nfunction isUndefined(arg) {\n  return arg === void 0;\n}\n","(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){\n// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\nfunction EventEmitter() {\n  this._events = this._events || {};\n  this._maxListeners = this._maxListeners || undefined;\n}\nmodule.exports = EventEmitter;\n\n// Backwards-compat with node 0.10.x\nEventEmitter.EventEmitter = EventEmitter;\n\nEventEmitter.prototype._events = undefined;\nEventEmitter.prototype._maxListeners = undefined;\n\n// By default EventEmitters will print a warning if more than 10 listeners are\n// added to it. This is a useful default which helps finding memory leaks.\nEventEmitter.defaultMaxListeners = 10;\n\n// Obviously not all Emitters should be limited to 10. This function allows\n// that to be increased. Set to zero for unlimited.\nEventEmitter.prototype.setMaxListeners = function(n) {\n  if (!isNumber(n) || n < 0 || isNaN(n))\n    throw TypeError('n must be a positive number');\n  this._maxListeners = n;\n  return this;\n};\n\nEventEmitter.prototype.emit = function(type) {\n  var er, handler, len, args, i, listeners;\n\n  if (!this._events)\n    this._events = {};\n\n  // If there is no 'error' event listener then throw.\n  if (type === 'error') {\n    if (!this._events.error ||\n        (isObject(this._events.error) && !this._events.error.length)) {\n      er = arguments[1];\n      if (er instanceof Error) {\n        throw er; // Unhandled 'error' event\n      }\n      throw TypeError('Uncaught, unspecified \"error\" event.');\n    }\n  }\n\n  handler = this._events[type];\n\n  if (isUndefined(handler))\n    return false;\n\n  if (isFunction(handler)) {\n    switch (arguments.length) {\n      // fast cases\n      case 1:\n        handler.call(this);\n        break;\n      case 2:\n        handler.call(this, arguments[1]);\n        break;\n      case 3:\n        handler.call(this, arguments[1], arguments[2]);\n        break;\n      // slower\n      default:\n        args = Array.prototype.slice.call(arguments, 1);\n        handler.apply(this, args);\n    }\n  } else if (isObject(handler)) {\n    args = Array.prototype.slice.call(arguments, 1);\n    listeners = handler.slice();\n    len = listeners.length;\n    for (i = 0; i < len; i++)\n      listeners[i].apply(this, args);\n  }\n\n  return true;\n};\n\nEventEmitter.prototype.addListener = function(type, listener) {\n  var m;\n\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  if (!this._events)\n    this._events = {};\n\n  // To avoid recursion in the case that type === \"newListener\"! Before\n  // adding it to the listeners, first emit \"newListener\".\n  if (this._events.newListener)\n    this.emit('newListener', type,\n              isFunction(listener.listener) ?\n              listener.listener : listener);\n\n  if (!this._events[type])\n    // Optimize the case of one listener. Don't need the extra array object.\n    this._events[type] = listener;\n  else if (isObject(this._events[type]))\n    // If we've already got an array, just append.\n    this._events[type].push(listener);\n  else\n    // Adding the second element, need to change to array.\n    this._events[type] = [this._events[type], listener];\n\n  // Check for listener leak\n  if (isObject(this._events[type]) && !this._events[type].warned) {\n    if (!isUndefined(this._maxListeners)) {\n      m = this._maxListeners;\n    } else {\n      m = EventEmitter.defaultMaxListeners;\n    }\n\n    if (m && m > 0 && this._events[type].length > m) {\n      this._events[type].warned = true;\n      console.error('(node) warning: possible EventEmitter memory ' +\n                    'leak detected. %d listeners added. ' +\n                    'Use emitter.setMaxListeners() to increase limit.',\n                    this._events[type].length);\n      if (typeof console.trace === 'function') {\n        // not supported in IE 10\n        console.trace();\n      }\n    }\n  }\n\n  return this;\n};\n\nEventEmitter.prototype.on = EventEmitter.prototype.addListener;\n\nEventEmitter.prototype.once = function(type, listener) {\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  var fired = false;\n\n  function g() {\n    this.removeListener(type, g);\n\n    if (!fired) {\n      fired = true;\n      listener.apply(this, arguments);\n    }\n  }\n\n  g.listener = listener;\n  this.on(type, g);\n\n  return this;\n};\n\n// emits a 'removeListener' event iff the listener was removed\nEventEmitter.prototype.removeListener = function(type, listener) {\n  var list, position, length, i;\n\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  if (!this._events || !this._events[type])\n    return this;\n\n  list = this._events[type];\n  length = list.length;\n  position = -1;\n\n  if (list === listener ||\n      (isFunction(list.listener) && list.listener === listener)) {\n    delete this._events[type];\n    if (this._events.removeListener)\n      this.emit('removeListener', type, listener);\n\n  } else if (isObject(list)) {\n    for (i = length; i-- > 0;) {\n      if (list[i] === listener ||\n          (list[i].listener && list[i].listener === listener)) {\n        position = i;\n        break;\n      }\n    }\n\n    if (position < 0)\n      return this;\n\n    if (list.length === 1) {\n      list.length = 0;\n      delete this._events[type];\n    } else {\n      list.splice(position, 1);\n    }\n\n    if (this._events.removeListener)\n      this.emit('removeListener', type, listener);\n  }\n\n  return this;\n};\n\nEventEmitter.prototype.removeAllListeners = function(type) {\n  var key, listeners;\n\n  if (!this._events)\n    return this;\n\n  // not listening for removeListener, no need to emit\n  if (!this._events.removeListener) {\n    if (arguments.length === 0)\n      this._events = {};\n    else if (this._events[type])\n      delete this._events[type];\n    return this;\n  }\n\n  // emit removeListener for all listeners on all events\n  if (arguments.length === 0) {\n    for (key in this._events) {\n      if (key === 'removeListener') continue;\n      this.removeAllListeners(key);\n    }\n    this.removeAllListeners('removeListener');\n    this._events = {};\n    return this;\n  }\n\n  listeners = this._events[type];\n\n  if (isFunction(listeners)) {\n    this.removeListener(type, listeners);\n  } else if (listeners) {\n    // LIFO order\n    while (listeners.length)\n      this.removeListener(type, listeners[listeners.length - 1]);\n  }\n  delete this._events[type];\n\n  return this;\n};\n\nEventEmitter.prototype.listeners = function(type) {\n  var ret;\n  if (!this._events || !this._events[type])\n    ret = [];\n  else if (isFunction(this._events[type]))\n    ret = [this._events[type]];\n  else\n    ret = this._events[type].slice();\n  return ret;\n};\n\nEventEmitter.prototype.listenerCount = function(type) {\n  if (this._events) {\n    var evlistener = this._events[type];\n\n    if (isFunction(evlistener))\n      return 1;\n    else if (evlistener)\n      return evlistener.length;\n  }\n  return 0;\n};\n\nEventEmitter.listenerCount = function(emitter, type) {\n  return emitter.listenerCount(type);\n};\n\nfunction isFunction(arg) {\n  return typeof arg === 'function';\n}\n\nfunction isNumber(arg) {\n  return typeof arg === 'number';\n}\n\nfunction isObject(arg) {\n  return typeof arg === 'object' && arg !== null;\n}\n\nfunction isUndefined(arg) {\n  return arg === void 0;\n}\n\n},{}],2:[function(require,module,exports){\n\"use strict\";\n\nvar _map = require(\"./map.js\");\n\nvar _map2 = _interopRequireDefault(_map);\n\nvar _overlay = require(\"./overlay.js\");\n\nvar _overlay2 = _interopRequireDefault(_overlay);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar $map = document.getElementsByClassName(\"map\")[0];\nvar mapDefaults = {\n  center: {\n    lat: 52.3942358,\n    lng: -2.2905\n  },\n  zoom: 7\n};\n\nvar map = new _map2.default({\n  el: $map,\n  defaults: mapDefaults,\n  input: document.getElementById(\"input\"),\n  countryCode: \"GB\"\n});\n\nvar overlay = new _overlay2.default(map);\n\n},{\"./map.js\":3,\"./overlay.js\":4}],3:[function(require,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol ? \"symbol\" : typeof obj; };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _events = require(\"events\");\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar Map = function (_EventEmitter) {\n  _inherits(Map, _EventEmitter);\n\n  function Map() {\n    _classCallCheck(this, Map);\n\n    var _this = _possibleConstructorReturn(this, Object.getPrototypeOf(Map).call(this));\n\n    var date = Date.now();\n    _this.body = document.body;\n    _this.settings = arguments[0];\n    _this.markers = {}; // stores markers\n    if (!((typeof google === \"undefined\" ? \"undefined\" : _typeof(google)) === \"object\" && google.hasOwnProperty(\"maps\"))) {\n      // if no google script\n      var script = document.createElement(\"SCRIPT\");\n      script.src = \"https://maps.googleapis.com/maps/api/js?libraries=places&callback=Map\" + date;\n      script.defer = true;\n      script.async = true;\n      _this.body.appendChild(script);\n\n      window[\"Map\" + date] = _this.initMap.bind(_this);\n    } else {\n      _this.initMap();\n    }\n    return _this;\n  }\n\n  _createClass(Map, [{\n    key: \"initMap\",\n    value: function initMap() {\n      var settings = Object.assign(this.settings.defaults, {\n        streetViewControl: false\n      });\n      //this.settings.defaults.streetViewControl = false;\n\n      this.map = new google.maps.Map(this.settings.el, settings);\n      this.geocoder = new google.maps.Geocoder();\n      this.autocomplete = new google.maps.places.Autocomplete(this.settings.input, {\n        types: [\"(cities)\"],\n        componentRestrictions: {\n          country: this.settings.countryCode\n        }\n      });\n\n      this.autocomplete.addListener(\"place_changed\", this.placeChanged.bind(this));\n      this.emit(\"loaded\");\n    }\n  }, {\n    key: \"placeChanged\",\n    value: function placeChanged() {\n      var place = this.autocomplete.getPlace();\n\n      if (place.hasOwnProperty(\"geometry\")) {\n        //this.updateMap(place);\n        this.emit(\"gotPlace\", place);\n      } else {\n        this.emit(\"error\", {\n          code: 1,\n          msg: \"No geometry property on place object\",\n          data: place\n        });\n      }\n    }\n  }, {\n    key: \"updateMap\",\n    value: function updateMap(obj) {\n\n      var bounds = {\n        north: obj.geometry.viewport.R.j,\n        east: obj.geometry.viewport.j.R,\n        south: obj.geometry.viewport.R.R,\n        west: obj.geometry.viewport.j.j\n      };\n\n      obj.bounds = bounds;\n\n      this.map.setOptions({\n        center: {\n          lat: obj.geometry.location.lat(),\n          lng: obj.geometry.location.lng()\n        },\n        zoom: 12\n      });\n\n      if (!this.hasOwnProperty(\"rectangle\")) {\n        this.rectangle = new google.maps.Rectangle({\n          bounds: bounds,\n          map: this.map,\n          fillColor: \"#000000\",\n          fillOpacity: 0,\n          strokeColor: \"#FF0000\",\n          strokeOpacity: 0.8,\n          strokeWeight: 2\n        });\n      } else {\n        this.rectangle.setBounds(bounds);\n      }\n\n      this.emit(\"updated\", obj);\n    }\n  }, {\n    key: \"addMarkers\",\n    value: function addMarkers(obj) {\n      var key = obj.key;\n      var data = obj.data;\n\n\n      if (key === \"all\") throw \"can't use the key all\";\n      if (this.markers.hasOwnProperty(key)) throw \"already a property with the key \" + key;\n      this.markers[key] = [];\n\n      data.forEach(function (data) {\n        var lat = data.lat;\n        var lng = data.lng;\n\n        var marker = new google.maps.Marker({\n          position: {\n            lat: lat,\n            lng: lng\n          },\n          map: this.map\n        });\n\n        this.markers[key].push(marker);\n      }.bind(this));\n    }\n  }, {\n    key: \"removeMarkers\",\n    value: function removeMarkers(key) {\n\n      function clearMarkers(arr) {\n        arr.forEach(function (marker) {\n          marker.setMap(null);\n        });\n      }\n\n      if (key === \"all\") {\n        for (var _key in this.markers) {\n          clearMarkers(this.markers[_key]);\n        }\n        this.markers = [];\n      } else {\n        clearMarkers(this.markers[key]);\n        //this.markers[key] = [];\n        delete this.markers[key];\n      }\n    }\n  }]);\n\n  return Map;\n}(_events.EventEmitter);\n\nexports.default = Map;\n;\n\n},{\"events\":1}],4:[function(require,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _events = require(\"events\");\n\nvar _policeApi = require(\"./police-api.js\");\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar Overlay = function (_EventEmitter) {\n  _inherits(Overlay, _EventEmitter);\n\n  function Overlay(map) {\n    _classCallCheck(this, Overlay);\n\n    var _this = _possibleConstructorReturn(this, Object.getPrototypeOf(Overlay).call(this));\n\n    _this.map = map;\n    _this.mapData = {\n      place: null,\n      poly: null\n    };\n    _this.el = {\n      $place: null,\n      $overlay: null,\n      $submit: null,\n      $year: null,\n      $month: null,\n      $policeData: null\n    };\n    _this.eventFns = {\n      click: [],\n      change: []\n    };\n    _this.possibleDates = null;\n    _this.loading = false;\n    _this.maxDate = null;\n    _this.policeData = {\n      requestEnd: null,\n      requestStart: null,\n      crimes: null\n    };\n    (0, _policeApi.lastUpdated)(function (err, obj) {\n      if (!err) {\n        var date = obj.date.split(\"-\").slice(0, 2);\n        date = new Date(date[0], date[1] - 1);\n        this.maxDate = date.getTime();\n        this.init();\n      }\n    }.bind(_this));\n\n    return _this;\n  }\n\n  _createClass(Overlay, [{\n    key: \"generateDates\",\n    value: function generateDates() {\n\n      var possibleDates = {};\n      var currentDate = new Date(2012, 0);\n      var keys = void 0;\n      var year = void 0;\n      var month = void 0;\n      var $options = void 0;\n      var endDate = this.maxDate;\n\n      while (currentDate.getTime() < endDate) {\n        var _year = currentDate.getFullYear();\n        var _month = currentDate.getMonth() + 1; // change to 1 based\n        if (!possibleDates.hasOwnProperty(_year)) {\n          possibleDates[_year] = [];\n        }\n        possibleDates[_year].push(_month);\n        currentDate.setMonth(currentDate.getMonth() + 1);\n      }\n\n      keys = Object.keys(possibleDates);\n      year = keys[keys.length - 1];\n      month = possibleDates[year];\n      month = month[month.length - 1];\n\n      this.el.$year.innerHTML = keys.map(function (key) {\n        return \"<option value=\\\"\" + key + \"\\\">\" + key + \"</option>\";\n      }).join(\"\");\n\n      $options = this.el.$year.getElementsByTagName(\"option\");\n      this.el.$year.value = $options[$options.length - 1].value;\n      this.possibleDates = possibleDates;\n      this.setMonths(year, month);\n      this.currentDate = year + \"-\" + month;\n    }\n  }, {\n    key: \"setMonths\",\n    value: function setMonths(year, monthToSelect) {\n      var months = this.possibleDates[year];\n\n      this.el.$month.innerHTML = months.map(function (key) {\n        return \"<option value=\\\"\" + key + \"\\\">\" + key + \"</option>\";\n      }).join(\"\");\n\n      if (monthToSelect) {\n        var i = monthToSelect;\n        if (!months[monthToSelect - 1]) {\n          i = 1;\n        }\n        var $months = this.el.$month.getElementsByTagName(\"option\");\n        this.el.$month.value = i;\n      }\n    }\n  }, {\n    key: \"gotPlace\",\n    value: function gotPlace(place) {\n      this.mapData.place = place;\n      this.mapData.poly = this.createPoly(place.geometry.viewport.R.j, place.geometry.viewport.j.R, place.geometry.viewport.R.R, place.geometry.viewport.j.j);\n    }\n  }, {\n    key: \"mapError\",\n    value: function mapError() {\n      console.log(arguments);\n    }\n  }, {\n    key: \"policeDataFn\",\n    value: function policeDataFn(err, res) {\n      var _this3 = this;\n\n      function changeData(str) {\n        var _this2 = this;\n\n        this.el.$policeData.innerHTML = str;\n        setTimeout(function () {\n          // allows opacity transition to work corretly\n          _this2.el.$policeData.classList.add(\"map-overlay__police-data--show\");\n        }, 50);\n      }\n\n      if (err) {\n        //    this.emit(\"error\", err)\n      } else {\n          (function () {\n            var crimes = {};\n            var str = \"\";\n            var requestDiff = void 0;\n\n            _this3.policeData.requestEnd = Date.now();\n\n            res.forEach(function (data) {\n              var category = data.category.replace(/-/g, \" \").split(\" \").map(function (text) {\n                return text.charAt(0).toUpperCase() + text.substr(1);\n              }).join(\" \");\n\n              if (!crimes.hasOwnProperty(category)) {\n                crimes[category] = [];\n              }\n              crimes[category].push(data);\n            });\n\n            for (var key in crimes) {\n              str += \"<div class='map-overlay__police-data__section' data-category=\\\"\" + key + \"\\\">\" + crimes[key].length + \" x \" + key + \"</div>\";\n            }\n            str += \"<p>Total: \" + res.length + \"</p>\";\n\n            requestDiff = _this3.policeData.requestEnd - _this3.policeData.requestStart;\n            _this3.policeData.crimes = crimes;\n\n            if (requestDiff < 1000) {\n              setTimeout(function () {\n                changeData.call(_this3, [str]);\n              }, 1000 - requestDiff);\n            } else {\n              changeData.call(_this3, [str]);\n            }\n          })();\n        }\n    }\n  }, {\n    key: \"createPoly\",\n    value: function createPoly(north, east, south, west) {\n      var poly = north + \",\" + east + \":\" + south + \",\" + east + \":\" + south + \",\" + west + \":\" + north + \",\" + west;\n      return poly;\n    }\n  }, {\n    key: \"submitClick\",\n    value: function submitClick() {\n      if (this.el.$place.value.trim() === \"\") {\n        console.log(\"PLEASE SELECT A PLACE\");\n      } else {\n        var formattedDate = this.el.$year.value + \"-\" + this.el.$month.value;\n        this.map.updateMap(this.mapData.place);\n        this.loading = true;\n        this.policeData.requestStart = Date.now();\n        (0, _policeApi.getData)({\n          poly: this.mapData.poly,\n          date: formattedDate,\n          callback: this.policeDataFn.bind(this)\n        });\n      }\n    }\n  }, {\n    key: \"dataClick\",\n    value: function dataClick(target) {\n      var key = target.getAttribute(\"data-category\");\n      if (target.classList.contains(\"map-overlay__police-data__section--active\")) {\n        // remove markers\n        target.classList.remove(\"map-overlay__police-data__section--active\");\n        this.map.removeMarkers(key);\n      } else {\n        // add markers\n        var crimes = this.policeData.crimes[key].map(function (obj) {\n          return {\n            lat: parseFloat(obj.location.latitude),\n            lng: parseFloat(obj.location.longitude)\n          };\n        });\n        target.classList.add(\"map-overlay__police-data__section--active\");\n        this.map.addMarkers({\n          key: key,\n          data: crimes\n        });\n      }\n    }\n  }, {\n    key: \"yearChange\",\n    value: function yearChange() {\n      var year = this.el.$year.value;\n      var month = this.el.$month.value;\n      this.setMonths(year, month);\n    }\n\n    // one main eventHandler function\n\n  }, {\n    key: \"eventHandler\",\n    value: function eventHandler(root, e) {\n      var target = e.target;\n\n      var oTarget = target;\n      var fns = this.eventFns[e.type];\n      var _ = this;\n\n      if (Array.isArray(fns)) {\n        fns.forEach(function (obj) {\n          var found = false;\n          target = oTarget;\n\n          while (!found && !target.isSameNode(root)) {\n\n            if (typeof obj.el === \"string\") {\n\n              if (target.classList.contains(obj.el)) {\n                found = true;\n              } else {\n                target = target.parentElement;\n              }\n            } else {\n              if (target.isSameNode(obj.el)) {\n                found = true;\n              } else {\n                target = target.parentElement;\n              }\n            }\n          }\n\n          if (found) {\n            obj.fn.call(_, target);\n          }\n        });\n      }\n    }\n  }, {\n    key: \"init\",\n    value: function init() {\n      this.el.$overlay = document.getElementsByClassName(\"map-overlay\")[0];\n      this.el.$submit = this.el.$overlay.getElementsByClassName(\"map-overlay__button\")[0];\n      this.el.$place = this.el.$overlay.getElementsByClassName(\"map-overlay__input\")[0];\n      this.el.$year = this.el.$overlay.getElementsByClassName(\"map-overlay__year-select\")[0];\n      this.el.$month = this.el.$overlay.getElementsByClassName(\"map-overlay__month-select\")[0];\n      this.el.$policeData = this.el.$overlay.getElementsByClassName(\"map-overlay__police-data\")[0];\n\n      this.generateDates();\n\n      this.map.on(\"gotPlace\", this.gotPlace.bind(this)).on(\"error\", this.mapError.bind(this));\n\n      // trying something new with event handlers - don't hate\n      this.el.$overlay.addEventListener(\"click\", this.eventHandler.bind(this, this.el.$overlay));\n      this.el.$overlay.addEventListener(\"change\", this.eventHandler.bind(this, this.el.$overlay));\n\n      this.eventFns.change.push({\n        el: this.el.$year,\n        fn: this.yearChange\n      });\n\n      this.eventFns.click.push({\n        el: this.el.$submit,\n        fn: this.submitClick\n      });\n\n      this.eventFns.click.push({\n        el: \"map-overlay__police-data__section\",\n        fn: this.dataClick\n      });\n\n      this.el.$overlay.classList.add(\"map-overlay--show\");\n    }\n  }]);\n\n  return Overlay;\n}(_events.EventEmitter);\n\nexports.default = Overlay;\n\n},{\"./police-api.js\":5,\"events\":1}],5:[function(require,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.getData = getData;\nexports.lastUpdated = lastUpdated;\nvar endpoint = \"https://data.police.uk/api/crimes-street/all-crime\";\n\nfunction getData(obj) {\n  var date = obj.date;\n  var poly = obj.poly;\n  var callback = obj.callback;\n\n\n  fetch(endpoint + (\"?poly=\" + poly + \"&date=\" + date)).then(function (res) {\n    return res.json();\n  }).then(function (data) {\n    callback(null, data);\n  }).catch(function (err) {\n    callback(err);\n  });\n}\n\nfunction lastUpdated(callback) {\n\n  fetch(\"https://data.police.uk/api/crime-last-updated\").then(function (res) {\n    return res.json();\n  }).then(function (data) {\n    callback(null, data);\n  }).catch(function (err) {\n    callback(err);\n  });\n}\n\n},{}]},{},[2])\n\n","import Map from \"./map.js\";\r\nimport Overlay from  \"./overlay.js\";\r\n\r\nconst $map = document.getElementsByClassName(\"map\")[0];\r\nconst mapDefaults = {\r\n  center: {\r\n    lat: 52.3942358,\r\n    lng: -2.2905\r\n  },\r\n  zoom: 7\r\n};\r\n\r\nconst map = new Map({\r\n  el:$map,\r\n  defaults:mapDefaults,\r\n  input:document.getElementById(\"input\"),\r\n  countryCode:\"GB\"\r\n});\r\n\r\nconst overlay = new Overlay(map);\r\n","import {\r\n  EventEmitter\r\n} from \"events\";\r\n\r\nexport default class Map extends EventEmitter {\r\n  constructor() {\r\n    super();\r\n    const date = Date.now();\r\n    this.body = document.body;\r\n    this.settings = arguments[0];\r\n    this.markers = {}; // stores markers\r\n    if (!(typeof google === \"object\" && google.hasOwnProperty(\"maps\"))) { // if no google script\r\n      const script = document.createElement(\"SCRIPT\");\r\n      script.src = \"https://maps.googleapis.com/maps/api/js?libraries=places&callback=Map\" + date;\r\n      script.defer = true;\r\n      script.async = true;\r\n      this.body.appendChild(script);\r\n\r\n      window[\"Map\" + date] = this.initMap.bind(this);\r\n    } else {\r\n      this.initMap();\r\n    }\r\n  }\r\n\r\n  initMap() {\r\n    let settings = Object.assign(this.settings.defaults, {\r\n      streetViewControl:false\r\n    });\r\n    //this.settings.defaults.streetViewControl = false;\r\n\r\n    this.map = new google.maps.Map(this.settings.el, settings);\r\n    this.geocoder = new google.maps.Geocoder();\r\n    this.autocomplete = new google.maps.places.Autocomplete(this.settings.input, {\r\n      types: [\"(cities)\"],\r\n      componentRestrictions: {\r\n        country: this.settings.countryCode\r\n      }\r\n    });\r\n\r\n    this.autocomplete.addListener(\"place_changed\", this.placeChanged.bind(this));\r\n    this.emit(\"loaded\");\r\n  }\r\n\r\n\r\n  placeChanged() {\r\n    const place = this.autocomplete.getPlace();\r\n\r\n    if (place.hasOwnProperty(\"geometry\")) {\r\n      //this.updateMap(place);\r\n      this.emit(\"gotPlace\", place);\r\n    } else {\r\n      this.emit(\"error\", {\r\n        code: 1,\r\n        msg: \"No geometry property on place object\",\r\n        data:place\r\n      });\r\n    }\r\n  }\r\n\r\n\r\n  updateMap(obj) {\r\n\r\n    const bounds = {\r\n      north: obj.geometry.viewport.R.j,\r\n      east: obj.geometry.viewport.j.R,\r\n      south: obj.geometry.viewport.R.R,\r\n      west: obj.geometry.viewport.j.j\r\n    };\r\n\r\n    obj.bounds = bounds;\r\n\r\n    this.map.setOptions({\r\n      center: {\r\n        lat: obj.geometry.location.lat(),\r\n        lng: obj.geometry.location.lng()\r\n      },\r\n      zoom: 12\r\n    });\r\n\r\n    if (!this.hasOwnProperty(\"rectangle\")) {\r\n      this.rectangle = new google.maps.Rectangle({\r\n        bounds,\r\n        map: this.map,\r\n        fillColor: \"#000000\",\r\n        fillOpacity: 0,\r\n        strokeColor: \"#FF0000\",\r\n        strokeOpacity: 0.8,\r\n        strokeWeight: 2\r\n      });\r\n\r\n    } else {\r\n      this.rectangle.setBounds(bounds);\r\n    }\r\n\r\n    this.emit(\"updated\", obj);\r\n  }\r\n\r\n  addMarkers(obj) {\r\n    const {\r\n      key,\r\n      data\r\n    } = obj;\r\n\r\n    if (key === \"all\") throw \"can't use the key all\";\r\n    if (this.markers.hasOwnProperty(key)) throw \"already a property with the key \" + key;\r\n    this.markers[key] = [];\r\n\r\n    data.forEach(function(data) {\r\n      const {\r\n        lat,\r\n        lng\r\n      } = data;\r\n      const  marker = new google.maps.Marker({\r\n        position:{\r\n          lat,\r\n          lng\r\n        },\r\n        map: this.map,\r\n      });\r\n\r\n      this.markers[key].push(marker);\r\n\r\n    }.bind(this));\r\n  }\r\n\r\n  removeMarkers(key) {\r\n    \r\n    function clearMarkers(arr) {\r\n      arr.forEach(function(marker) {\r\n        marker.setMap(null);\r\n      });\r\n    }\r\n\r\n    if(key === \"all\"){\r\n      for (let key in this.markers){\r\n        clearMarkers(this.markers[key]);\r\n      }\r\n      this.markers = [];\r\n    }\r\n    else{\r\n      clearMarkers(this.markers[key]);\r\n      //this.markers[key] = [];\r\n      delete this.markers[key];\r\n    }\r\n\r\n  }\r\n\r\n};\r\n","import {\r\n  EventEmitter\r\n} from \"events\";\r\nimport {\r\n  getData,\r\n  lastUpdated\r\n} from \"./police-api.js\";\r\n\r\nexport default class Overlay extends EventEmitter {\r\n  constructor(map) {\r\n\r\n    super();\r\n    this.map = map;\r\n    this.mapData = {\r\n      place: null,\r\n      poly:null\r\n    };\r\n    this.el = {\r\n      $place:null,\r\n      $overlay: null,\r\n      $submit: null,\r\n      $year: null,\r\n      $month: null,\r\n      $policeData:null\r\n    }\r\n    this.eventFns = {\r\n      click: [],\r\n      change: []\r\n    }\r\n    this.possibleDates = null;\r\n    this.loading = false;\r\n    this.maxDate = null;\r\n    this.policeData = {\r\n      requestEnd:null,\r\n      requestStart:null,\r\n      crimes:null\r\n    }\r\n    lastUpdated(function(err, obj) {\r\n      if (!err) {\r\n        let date = obj.date.split(\"-\").slice(0, 2);\r\n        date = new Date(date[0], date[1] - 1);\r\n        this.maxDate = date.getTime();\r\n        this.init();\r\n      }\r\n    }.bind(this));\r\n\r\n  }\r\n\r\n\r\n\r\n  generateDates() {\r\n\r\n    let possibleDates = {};\r\n    let currentDate = new Date(2012, 0);\r\n    let keys;\r\n    let year;\r\n    let month;\r\n    let $options;\r\n    const endDate = this.maxDate;\r\n\r\n    while (currentDate.getTime() < endDate) {\r\n      const year = currentDate.getFullYear();\r\n      const month = currentDate.getMonth() + 1; // change to 1 based\r\n      if (!possibleDates.hasOwnProperty(year)) {\r\n        possibleDates[year] = [];\r\n      }\r\n      possibleDates[year].push(month);\r\n      currentDate.setMonth(currentDate.getMonth() + 1);\r\n    }\r\n\r\n    keys = Object.keys(possibleDates);\r\n    year = keys[keys.length - 1];\r\n    month = possibleDates[year];\r\n    month = month[month.length - 1];\r\n\r\n\r\n    this.el.$year.innerHTML = keys.map(function(key) {\r\n      return `<option value=\"${key}\">${key}</option>`;\r\n    }).join(\"\");\r\n\r\n    $options = this.el.$year.getElementsByTagName(\"option\");\r\n    this.el.$year.value = $options[$options.length - 1].value;\r\n    this.possibleDates = possibleDates;\r\n    this.setMonths(year, month);\r\n    this.currentDate = year + \"-\" + month;\r\n  }\r\n\r\n  setMonths(year, monthToSelect) {\r\n    const months = this.possibleDates[year];\r\n\r\n    this.el.$month.innerHTML = months.map(function(key) {\r\n      return `<option value=\"${key}\">${key}</option>`;\r\n    }).join(\"\");\r\n\r\n\r\n    if (monthToSelect) {\r\n      let i = monthToSelect;\r\n      if (!months[monthToSelect - 1]) {\r\n        i = 1;\r\n      }\r\n      const $months = this.el.$month.getElementsByTagName(\"option\");\r\n      this.el.$month.value = i;\r\n    }\r\n\r\n  }\r\n\r\n\r\n\r\n  gotPlace(place) {\r\n    this.mapData.place = place;\r\n    this.mapData.poly = this.createPoly(place.geometry.viewport.R.j,place.geometry.viewport.j.R,place.geometry.viewport.R.R,place.geometry.viewport.j.j);\r\n  }\r\n\r\n  mapError() {\r\n    console.log(arguments);\r\n  }\r\n\r\n  policeDataFn(err, res){\r\n    function changeData(str) {\r\n\r\n      this.el.$policeData.innerHTML = str;\r\n      setTimeout(() => { // allows opacity transition to work corretly\r\n        this.el.$policeData.classList.add(\"map-overlay__police-data--show\");\r\n      }, 50);\r\n    }\r\n\r\n    if (err) {\r\n  //    this.emit(\"error\", err)\r\n    } else {\r\n      let crimes = {};\r\n      let str = \"\";\r\n      let requestDiff;\r\n\r\n      this.policeData.requestEnd = Date.now();\r\n\r\n      res.forEach(function(data) {\r\n        let category = data.category.replace(/-/g, \" \")\r\n          .split(\" \").map(function(text) {\r\n            return text.charAt(0).toUpperCase() + text.substr(1);\r\n          }).join(\" \");\r\n\r\n        if (!crimes.hasOwnProperty(category)) {\r\n          crimes[category] = [];\r\n        }\r\n        crimes[category].push(data);\r\n      });\r\n\r\n\r\n      for (let key in crimes) {\r\n        str += `<div class='map-overlay__police-data__section' data-category=\"${key}\">${crimes[key].length} x ${key}</div>`;\r\n      }\r\n      str += `<p>Total: ${res.length}</p>`\r\n\r\n      requestDiff = this.policeData.requestEnd - this.policeData.requestStart;\r\n      this.policeData.crimes = crimes;\r\n\r\n      if (requestDiff < 1000) {\r\n        setTimeout(() => {\r\n          changeData.call(this, [str]);\r\n        }, 1000 - requestDiff);\r\n      } else {\r\n        changeData.call(this, [str]);\r\n      }\r\n\r\n    }\r\n  }\r\n\r\n   createPoly(north, east, south, west) {\r\n    const poly = `${north},${east}:${south},${east}:${south},${west}:${north},${west}`;\r\n    return poly;\r\n  }\r\n\r\n  submitClick() {\r\n    if (this.el.$place.value.trim() === \"\") {\r\n      console.log(\"PLEASE SELECT A PLACE\");\r\n    } else {\r\n      const formattedDate = this.el.$year.value + \"-\" + this.el.$month.value;\r\n      this.map.updateMap(this.mapData.place);\r\n      this.loading = true;\r\n      this.policeData.requestStart = Date.now();\r\n      getData({\r\n        poly:this.mapData.poly,\r\n        date:formattedDate,\r\n        callback:this.policeDataFn.bind(this)\r\n      });\r\n\r\n    }\r\n  }\r\n\r\n  dataClick(target){\r\n    let key = target.getAttribute(\"data-category\");\r\n    if (target.classList.contains(\"map-overlay__police-data__section--active\")) { // remove markers\r\n      target.classList.remove(\"map-overlay__police-data__section--active\");\r\n      this.map.removeMarkers(key);\r\n    } else { // add markers\r\n      let crimes = this.policeData.crimes[key].map(function(obj) {\r\n        return {\r\n          lat: parseFloat(obj.location.latitude),\r\n          lng: parseFloat(obj.location.longitude)\r\n        };\r\n      });\r\n      target.classList.add(\"map-overlay__police-data__section--active\");\r\n      this.map.addMarkers({\r\n        key,\r\n        data: crimes\r\n      });\r\n    }\r\n  }\r\n\r\n  yearChange() {\r\n    const year = this.el.$year.value;\r\n    const month = this.el.$month.value\r\n    this.setMonths(year, month);\r\n  }\r\n\r\n  // one main eventHandler function\r\n  eventHandler(root, e) {\r\n\r\n    let {\r\n      target\r\n    } = e;\r\n    const oTarget = target;\r\n    const fns = this.eventFns[e.type];\r\n    const _ = this;\r\n\r\n    if (Array.isArray(fns)) {\r\n      fns.forEach(function(obj) {\r\n        let found = false;\r\n        target = oTarget;\r\n\r\n        while (!found && !target.isSameNode(root)) {\r\n\r\n          if(typeof obj.el === \"string\"){\r\n\r\n            if(target.classList.contains(obj.el)){\r\n              found = true;\r\n            }\r\n            else{\r\n              target = target.parentElement;\r\n            }\r\n          }\r\n          else{\r\n            if (target.isSameNode(obj.el)) {\r\n              found = true;\r\n            } else {\r\n              target = target.parentElement;\r\n            }\r\n          }\r\n\r\n        }\r\n\r\n\r\n        if (found) {\r\n          obj.fn.call(_, target);\r\n        }\r\n      });\r\n    }\r\n\r\n\r\n  }\r\n\r\n  init() {\r\n    this.el.$overlay = document.getElementsByClassName(\"map-overlay\")[0];\r\n    this.el.$submit = this.el.$overlay.getElementsByClassName(\"map-overlay__button\")[0];\r\n    this.el.$place = this.el.$overlay.getElementsByClassName(\"map-overlay__input\")[0];\r\n    this.el.$year = this.el.$overlay.getElementsByClassName(\"map-overlay__year-select\")[0];\r\n    this.el.$month = this.el.$overlay.getElementsByClassName(\"map-overlay__month-select\")[0];\r\n    this.el.$policeData = this.el.$overlay.getElementsByClassName(\"map-overlay__police-data\")[0];\r\n\r\n    this.generateDates();\r\n\r\n    this.map\r\n      .on(\"gotPlace\", this.gotPlace.bind(this))\r\n      .on(\"error\", this.mapError.bind(this));\r\n\r\n    // trying something new with event handlers - don't hate\r\n    this.el.$overlay.addEventListener(\"click\", this.eventHandler.bind(this, this.el.$overlay));\r\n    this.el.$overlay.addEventListener(\"change\", this.eventHandler.bind(this, this.el.$overlay));\r\n\r\n    this.eventFns.change.push({\r\n      el: this.el.$year,\r\n      fn: this.yearChange\r\n    });\r\n\r\n    this.eventFns.click.push({\r\n      el: this.el.$submit,\r\n      fn: this.submitClick\r\n    });\r\n\r\n    this.eventFns.click.push({\r\n      el:\"map-overlay__police-data__section\",\r\n      fn:this.dataClick\r\n    })\r\n\r\n    this.el.$overlay.classList.add(\"map-overlay--show\");\r\n  }\r\n\r\n\r\n\r\n}\r\n","const endpoint = \"https://data.police.uk/api/crimes-street/all-crime\";\r\n\r\nexport function getData(obj) {\r\n  const { date, poly, callback } = obj;\r\n\r\n  fetch(endpoint +`?poly=${poly}&date=${date}`)\r\n  .then(function(res) {\r\n    return res.json();\r\n  })\r\n  .then(function(data) {\r\n    callback(null, data);\r\n  })\r\n  .catch(function(err) {\r\n    callback(err);\r\n  });\r\n}\r\n\r\nexport function lastUpdated(callback){\r\n\r\n  fetch(\"https://data.police.uk/api/crime-last-updated\")\r\n  .then(function(res) {\r\n    return res.json();\r\n  })\r\n  .then(function(data) {\r\n    callback(null, data);\r\n  })\r\n  .catch(function(err) {\r\n    callback(err);\r\n  });\r\n\r\n}\r\n"],"sourceRoot":"/"}