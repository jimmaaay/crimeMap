!function t(e,n,r){function o(s,a){if(!n[s]){if(!e[s]){var l="function"==typeof require&&require;if(!a&&l)return l(s,!0);if(i)return i(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var c=n[s]={exports:{}};e[s][0].call(c.exports,function(t){var n=e[s][1][t];return o(n?n:t)},c,c.exports,t,e,n,r)}return n[s].exports}for(var i="function"==typeof require&&require,s=0;s<r.length;s++)o(r[s]);return o}({1:[function(t,e,n){function r(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function o(t){return"function"==typeof t}function i(t){return"number"==typeof t}function s(t){return"object"==typeof t&&null!==t}function a(t){return void 0===t}e.exports=r,r.EventEmitter=r,r.prototype._events=void 0,r.prototype._maxListeners=void 0,r.defaultMaxListeners=10,r.prototype.setMaxListeners=function(t){if(!i(t)||t<0||isNaN(t))throw TypeError("n must be a positive number");return this._maxListeners=t,this},r.prototype.emit=function(t){var e,n,r,i,l,u;if(this._events||(this._events={}),"error"===t&&(!this._events.error||s(this._events.error)&&!this._events.error.length)){if(e=arguments[1],e instanceof Error)throw e;var c=new Error('Uncaught, unspecified "error" event. ('+e+")");throw c.context=e,c}if(n=this._events[t],a(n))return!1;if(o(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:i=Array.prototype.slice.call(arguments,1),n.apply(this,i)}else if(s(n))for(i=Array.prototype.slice.call(arguments,1),u=n.slice(),r=u.length,l=0;l<r;l++)u[l].apply(this,i);return!0},r.prototype.addListener=function(t,e){var n;if(!o(e))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",t,o(e.listener)?e.listener:e),this._events[t]?s(this._events[t])?this._events[t].push(e):this._events[t]=[this._events[t],e]:this._events[t]=e,s(this._events[t])&&!this._events[t].warned&&(n=a(this._maxListeners)?r.defaultMaxListeners:this._maxListeners,n&&n>0&&this._events[t].length>n&&(this._events[t].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),"function"==typeof console.trace&&console.trace())),this},r.prototype.on=r.prototype.addListener,r.prototype.once=function(t,e){function n(){this.removeListener(t,n),r||(r=!0,e.apply(this,arguments))}if(!o(e))throw TypeError("listener must be a function");var r=!1;return n.listener=e,this.on(t,n),this},r.prototype.removeListener=function(t,e){var n,r,i,a;if(!o(e))throw TypeError("listener must be a function");if(!this._events||!this._events[t])return this;if(n=this._events[t],i=n.length,r=-1,n===e||o(n.listener)&&n.listener===e)delete this._events[t],this._events.removeListener&&this.emit("removeListener",t,e);else if(s(n)){for(a=i;a-- >0;)if(n[a]===e||n[a].listener&&n[a].listener===e){r=a;break}if(r<0)return this;1===n.length?(n.length=0,delete this._events[t]):n.splice(r,1),this._events.removeListener&&this.emit("removeListener",t,e)}return this},r.prototype.removeAllListeners=function(t){var e,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[t]&&delete this._events[t],this;if(0===arguments.length){for(e in this._events)"removeListener"!==e&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[t],o(n))this.removeListener(t,n);else if(n)for(;n.length;)this.removeListener(t,n[n.length-1]);return delete this._events[t],this},r.prototype.listeners=function(t){var e;return e=this._events&&this._events[t]?o(this._events[t])?[this._events[t]]:this._events[t].slice():[]},r.prototype.listenerCount=function(t){if(this._events){var e=this._events[t];if(o(e))return 1;if(e)return e.length}return 0},r.listenerCount=function(t,e){return t.listenerCount(e)}},{}],2:[function(t,e,n){function r(){h&&c&&(h=!1,c.length?p=c.concat(p):f=-1,p.length&&o())}function o(){if(!h){var t=a(r);h=!0;for(var e=p.length;e;){for(c=p,p=[];++f<e;)c&&c[f].run();f=-1,e=p.length}c=null,h=!1,l(t)}}function i(t,e){this.fun=t,this.array=e}function s(){}var a,l,u=e.exports={};!function(){try{a=setTimeout}catch(t){a=function(){throw new Error("setTimeout is not defined")}}try{l=clearTimeout}catch(t){l=function(){throw new Error("clearTimeout is not defined")}}}();var c,p=[],h=!1,f=-1;u.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];p.push(new i(t,e)),1!==p.length||h||a(o,0)},i.prototype.run=function(){this.fun.apply(null,this.array)},u.title="browser",u.browser=!0,u.env={},u.argv=[],u.version="",u.versions={},u.on=s,u.addListener=s,u.once=s,u.off=s,u.removeListener=s,u.removeAllListeners=s,u.emit=s,u.binding=function(t){throw new Error("process.binding is not supported")},u.cwd=function(){return"/"},u.chdir=function(t){throw new Error("process.chdir is not supported")},u.umask=function(){return 0}},{}],3:[function(t,e,n){(function(n,r){(function(){"use strict";function o(t){return"function"==typeof t||"object"==typeof t&&null!==t}function i(t){return"function"==typeof t}function s(t){V=t}function a(t){K=t}function l(){return function(){n.nextTick(f)}}function u(){return function(){G(f)}}function c(){var t=0,e=new et(f),n=document.createTextNode("");return e.observe(n,{characterData:!0}),function(){n.data=t=++t%2}}function p(){var t=new MessageChannel;return t.port1.onmessage=f,function(){t.port2.postMessage(0)}}function h(){return function(){setTimeout(f,1)}}function f(){for(var t=0;t<Z;t+=2){var e=ot[t],n=ot[t+1];e(n),ot[t]=void 0,ot[t+1]=void 0}Z=0}function y(){try{var e=t,n=e("vertx");return G=n.runOnLoop||n.runOnContext,u()}catch(r){return h()}}function d(t,e){var n=this,r=new this.constructor(m);void 0===r[at]&&B(r);var o=n._state;if(o){var i=arguments[o-1];K(function(){A(o,r,i,n._result)})}else D(n,r,t,e);return r}function v(t){var e=this;if(t&&"object"==typeof t&&t.constructor===e)return t;var n=new e(m);return k(n,t),n}function m(){}function b(){return new TypeError("You cannot resolve a promise with itself")}function g(){return new TypeError("A promises callback cannot return that same promise.")}function w(t){try{return t.then}catch(e){return pt.error=e,pt}}function _(t,e,n,r){try{t.call(e,n,r)}catch(o){return o}}function O(t,e,n){K(function(t){var r=!1,o=_(n,e,function(n){r||(r=!0,e!==n?k(t,n):L(t,n))},function(e){r||(r=!0,x(t,e))},"Settle: "+(t._label||" unknown promise"));!r&&o&&(r=!0,x(t,o))},t)}function E(t,e){e._state===ut?L(t,e._result):e._state===ct?x(t,e._result):D(e,void 0,function(e){k(t,e)},function(e){x(t,e)})}function j(t,e,n){e.constructor===t.constructor&&n===it&&constructor.resolve===st?E(t,e):n===pt?x(t,pt.error):void 0===n?L(t,e):i(n)?O(t,e,n):L(t,e)}function k(t,e){t===e?x(t,b()):o(e)?j(t,e,w(e)):L(t,e)}function T(t){t._onerror&&t._onerror(t._result),$(t)}function L(t,e){t._state===lt&&(t._result=e,t._state=ut,0!==t._subscribers.length&&K($,t))}function x(t,e){t._state===lt&&(t._state=ct,t._result=e,K(T,t))}function D(t,e,n,r){var o=t._subscribers,i=o.length;t._onerror=null,o[i]=e,o[i+ut]=n,o[i+ct]=r,0===i&&t._state&&K($,t)}function $(t){var e=t._subscribers,n=t._state;if(0!==e.length){for(var r,o,i=t._result,s=0;s<e.length;s+=3)r=e[s],o=e[s+n],r?A(n,r,o,i):o(i);t._subscribers.length=0}}function P(){this.error=null}function S(t,e){try{return t(e)}catch(n){return ht.error=n,ht}}function A(t,e,n,r){var o,s,a,l,u=i(n);if(u){if(o=S(n,r),o===ht?(l=!0,s=o.error,o=null):a=!0,e===o)return void x(e,g())}else o=r,a=!0;e._state!==lt||(u&&a?k(e,o):l?x(e,s):t===ut?L(e,o):t===ct&&x(e,o))}function C(t,e){try{e(function(e){k(t,e)},function(e){x(t,e)})}catch(n){x(t,n)}}function M(){return ft++}function B(t){t[at]=ft++,t._state=void 0,t._result=void 0,t._subscribers=[]}function F(t){return new bt(this,t).promise}function N(t){var e=this;return new e(W(t)?function(n,r){for(var o=t.length,i=0;i<o;i++)e.resolve(t[i]).then(n,r)}:function(t,e){e(new TypeError("You must pass an array to race."))})}function R(t){var e=this,n=new e(m);return x(n,t),n}function U(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function I(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function q(t){this[at]=M(),this._result=this._state=void 0,this._subscribers=[],m!==t&&("function"!=typeof t&&U(),this instanceof q?C(this,t):I())}function H(t,e){this._instanceConstructor=t,this.promise=new t(m),this.promise[at]||B(this.promise),W(e)?(this._input=e,this.length=e.length,this._remaining=e.length,this._result=new Array(this.length),0===this.length?L(this.promise,this._result):(this.length=this.length||0,this._enumerate(),0===this._remaining&&L(this.promise,this._result))):x(this.promise,Y())}function Y(){return new Error("Array Methods must be provided an Array")}function J(){var t;if("undefined"!=typeof r)t=r;else if("undefined"!=typeof self)t=self;else try{t=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var n=t.Promise;n&&"[object Promise]"===Object.prototype.toString.call(n.resolve())&&!n.cast||(t.Promise=mt)}var z;z=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)};var G,V,X,W=z,Z=0,K=function(t,e){ot[Z]=t,ot[Z+1]=e,Z+=2,2===Z&&(V?V(f):X())},Q="undefined"!=typeof window?window:void 0,tt=Q||{},et=tt.MutationObserver||tt.WebKitMutationObserver,nt="undefined"==typeof self&&"undefined"!=typeof n&&"[object process]"==={}.toString.call(n),rt="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,ot=new Array(1e3);X=nt?l():et?c():rt?p():void 0===Q&&"function"==typeof t?y():h();var it=d,st=v,at=Math.random().toString(36).substring(16),lt=void 0,ut=1,ct=2,pt=new P,ht=new P,ft=0,yt=F,dt=N,vt=R,mt=q;q.all=yt,q.race=dt,q.resolve=st,q.reject=vt,q._setScheduler=s,q._setAsap=a,q._asap=K,q.prototype={constructor:q,then:it,"catch":function(t){return this.then(null,t)}};var bt=H;H.prototype._enumerate=function(){for(var t=this.length,e=this._input,n=0;this._state===lt&&n<t;n++)this._eachEntry(e[n],n)},H.prototype._eachEntry=function(t,e){var n=this._instanceConstructor,r=n.resolve;if(r===st){var o=w(t);if(o===it&&t._state!==lt)this._settledAt(t._state,e,t._result);else if("function"!=typeof o)this._remaining--,this._result[e]=t;else if(n===mt){var i=new n(m);j(i,t,o),this._willSettleAt(i,e)}else this._willSettleAt(new n(function(e){e(t)}),e)}else this._willSettleAt(r(t),e)},H.prototype._settledAt=function(t,e,n){var r=this.promise;r._state===lt&&(this._remaining--,t===ct?x(r,n):this._result[e]=n),0===this._remaining&&L(r,this._result)},H.prototype._willSettleAt=function(t,e){var n=this;D(t,void 0,function(t){n._settledAt(ut,e,t)},function(t){n._settledAt(ct,e,t)})};var gt=J,wt={Promise:mt,polyfill:gt};"function"==typeof define&&define.amd?define(function(){return wt}):"undefined"!=typeof e&&e.exports?e.exports=wt:"undefined"!=typeof this&&(this.ES6Promise=wt),gt()}).call(this)}).call(this,t("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:2}],4:[function(t,e,n){"use strict";var r=t("object-keys");e.exports=function(){if("function"!=typeof Symbol||"function"!=typeof Object.getOwnPropertySymbols)return!1;if("symbol"==typeof Symbol.iterator)return!0;var t={},e=Symbol("test"),n=Object(e);if("string"==typeof e)return!1;if("[object Symbol]"!==Object.prototype.toString.call(e))return!1;if("[object Symbol]"!==Object.prototype.toString.call(n))return!1;var o=42;t[e]=o;for(e in t)return!1;if(0!==r(t).length)return!1;if("function"==typeof Object.keys&&0!==Object.keys(t).length)return!1;if("function"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(t).length)return!1;var i=Object.getOwnPropertySymbols(t);if(1!==i.length||i[0]!==e)return!1;if(!Object.prototype.propertyIsEnumerable.call(t,e))return!1;if("function"==typeof Object.getOwnPropertyDescriptor){var s=Object.getOwnPropertyDescriptor(t,e);if(s.value!==o||s.enumerable!==!0)return!1}return!0}},{"object-keys":8}],5:[function(t,e,n){"use strict";var r=t("object-keys"),o=t("function-bind"),i=function(t){return"undefined"!=typeof t&&null!==t},s=t("./hasSymbols")(),a=Object,l=o.call(Function.call,Array.prototype.push),u=o.call(Function.call,Object.prototype.propertyIsEnumerable),c=s?Object.getOwnPropertySymbols:null;e.exports=function(t,e){if(!i(t))throw new TypeError("target must be an object");var n,o,p,h,f,y,d,v=a(t);for(n=1;n<arguments.length;++n){o=a(arguments[n]),h=r(o);var m=s&&(Object.getOwnPropertySymbols||c);if(m)for(f=m(o),p=0;p<f.length;++p)d=f[p],u(o,d)&&l(h,d);for(p=0;p<h.length;++p)d=h[p],y=o[d],u(o,d)&&(v[d]=y)}return v}},{"./hasSymbols":4,"function-bind":7,"object-keys":8}],6:[function(t,e,n){var r="Function.prototype.bind called on incompatible ",o=Array.prototype.slice,i=Object.prototype.toString,s="[object Function]";e.exports=function(t){var e=this;if("function"!=typeof e||i.call(e)!==s)throw new TypeError(r+e);for(var n,a=o.call(arguments,1),l=function(){if(this instanceof n){var r=e.apply(this,a.concat(o.call(arguments)));return Object(r)===r?r:this}return e.apply(t,a.concat(o.call(arguments)))},u=Math.max(0,e.length-a.length),c=[],p=0;p<u;p++)c.push("$"+p);if(n=Function("binder","return function ("+c.join(",")+"){ return binder.apply(this,arguments); }")(l),e.prototype){var h=function(){};h.prototype=e.prototype,n.prototype=new h,h.prototype=null}return n}},{}],7:[function(t,e,n){var r=t("./implementation");e.exports=Function.prototype.bind||r},{"./implementation":6}],8:[function(t,e,n){"use strict";var r=Object.prototype.hasOwnProperty,o=Object.prototype.toString,i=Array.prototype.slice,s=t("./isArguments"),a=Object.prototype.propertyIsEnumerable,l=!a.call({toString:null},"toString"),u=a.call(function(){},"prototype"),c=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],p=function(t){var e=t.constructor;return e&&e.prototype===t},h={$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},f=function(){if("undefined"==typeof window)return!1;for(var t in window)try{if(!h["$"+t]&&r.call(window,t)&&null!==window[t]&&"object"==typeof window[t])try{p(window[t])}catch(e){return!0}}catch(e){return!0}return!1}(),y=function(t){if("undefined"==typeof window||!f)return p(t);try{return p(t)}catch(e){return!1}},d=function(t){var e=null!==t&&"object"==typeof t,n="[object Function]"===o.call(t),i=s(t),a=e&&"[object String]"===o.call(t),p=[];if(!e&&!n&&!i)throw new TypeError("Object.keys called on a non-object");var h=u&&n;if(a&&t.length>0&&!r.call(t,0))for(var f=0;f<t.length;++f)p.push(String(f));if(i&&t.length>0)for(var d=0;d<t.length;++d)p.push(String(d));else for(var v in t)h&&"prototype"===v||!r.call(t,v)||p.push(String(v));if(l)for(var m=y(t),b=0;b<c.length;++b)m&&"constructor"===c[b]||!r.call(t,c[b])||p.push(c[b]);return p};d.shim=function(){if(Object.keys){var t=function(){return 2===(Object.keys(arguments)||"").length}(1,2);if(!t){var e=Object.keys;Object.keys=function(t){return e(s(t)?i.call(t):t)}}}else Object.keys=d;return Object.keys||d},e.exports=d},{"./isArguments":9}],9:[function(t,e,n){"use strict";var r=Object.prototype.toString;e.exports=function(t){var e=r.call(t),n="[object Arguments]"===e;return n||(n="[object Array]"!==e&&null!==t&&"object"==typeof t&&"number"==typeof t.length&&t.length>=0&&"[object Function]"===r.call(t.callee)),n}},{}],10:[function(t,e,n){"use strict";var r=t("./implementation"),o=function(){if(!Object.assign)return!1;for(var t="abcdefghijklmnopqrst",e=t.split(""),n={},r=0;r<e.length;++r)n[e[r]]=e[r];var o=Object.assign({},n),i="";for(var s in o)i+=s;return t!==i},i=function(){if(!Object.assign||!Object.preventExtensions)return!1;var t=Object.preventExtensions({1:2});try{Object.assign(t,"xy")}catch(e){return"y"===t[1]}return!1};e.exports=function(){return Object.assign?o()?r:i()?r:Object.assign:r}},{"./implementation":5}],11:[function(t,e,n){!function(t){"use strict";function e(t){if("string"!=typeof t&&(t=String(t)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(t))throw new TypeError("Invalid character in header field name");return t.toLowerCase()}function n(t){return"string"!=typeof t&&(t=String(t)),t}function r(t){this.map={},t instanceof r?t.forEach(function(t,e){this.append(e,t)},this):t&&Object.getOwnPropertyNames(t).forEach(function(e){this.append(e,t[e])},this)}function o(t){return t.bodyUsed?Promise.reject(new TypeError("Already read")):void(t.bodyUsed=!0)}function i(t){return new Promise(function(e,n){t.onload=function(){e(t.result)},t.onerror=function(){n(t.error)}})}function s(t){var e=new FileReader;return e.readAsArrayBuffer(t),i(e)}function a(t){var e=new FileReader;return e.readAsText(t),i(e)}function l(){return this.bodyUsed=!1,this._initBody=function(t){if(this._bodyInit=t,"string"==typeof t)this._bodyText=t;else if(y.blob&&Blob.prototype.isPrototypeOf(t))this._bodyBlob=t;else if(y.formData&&FormData.prototype.isPrototypeOf(t))this._bodyFormData=t;else if(t){if(!y.arrayBuffer||!ArrayBuffer.prototype.isPrototypeOf(t))throw new Error("unsupported BodyInit type")}else this._bodyText="";this.headers.get("content-type")||("string"==typeof t?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type&&this.headers.set("content-type",this._bodyBlob.type))},y.blob?(this.blob=function(){var t=o(this);if(t)return t;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this.blob().then(s)},this.text=function(){var t=o(this);if(t)return t;if(this._bodyBlob)return a(this._bodyBlob);if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)}):this.text=function(){var t=o(this);return t?t:Promise.resolve(this._bodyText)},y.formData&&(this.formData=function(){return this.text().then(p)}),this.json=function(){return this.text().then(JSON.parse)},this}function u(t){var e=t.toUpperCase();return d.indexOf(e)>-1?e:t}function c(t,e){e=e||{};var n=e.body;if(c.prototype.isPrototypeOf(t)){if(t.bodyUsed)throw new TypeError("Already read");this.url=t.url,this.credentials=t.credentials,e.headers||(this.headers=new r(t.headers)),this.method=t.method,this.mode=t.mode,n||(n=t._bodyInit,t.bodyUsed=!0)}else this.url=t;if(this.credentials=e.credentials||this.credentials||"omit",!e.headers&&this.headers||(this.headers=new r(e.headers)),this.method=u(e.method||this.method||"GET"),this.mode=e.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&n)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(n)}function p(t){var e=new FormData;return t.trim().split("&").forEach(function(t){if(t){var n=t.split("="),r=n.shift().replace(/\+/g," "),o=n.join("=").replace(/\+/g," ");e.append(decodeURIComponent(r),decodeURIComponent(o))}}),e}function h(t){var e=new r,n=(t.getAllResponseHeaders()||"").trim().split("\n");return n.forEach(function(t){var n=t.trim().split(":"),r=n.shift().trim(),o=n.join(":").trim();e.append(r,o)}),e}function f(t,e){e||(e={}),this.type="default",this.status=e.status,this.ok=this.status>=200&&this.status<300,this.statusText=e.statusText,this.headers=e.headers instanceof r?e.headers:new r(e.headers),this.url=e.url||"",this._initBody(t)}if(!t.fetch){r.prototype.append=function(t,r){t=e(t),r=n(r);var o=this.map[t];o||(o=[],this.map[t]=o),o.push(r)},r.prototype["delete"]=function(t){delete this.map[e(t)]},r.prototype.get=function(t){var n=this.map[e(t)];return n?n[0]:null},r.prototype.getAll=function(t){return this.map[e(t)]||[]},r.prototype.has=function(t){return this.map.hasOwnProperty(e(t))},r.prototype.set=function(t,r){this.map[e(t)]=[n(r)]},r.prototype.forEach=function(t,e){Object.getOwnPropertyNames(this.map).forEach(function(n){this.map[n].forEach(function(r){t.call(e,r,n,this)},this)},this)};var y={blob:"FileReader"in t&&"Blob"in t&&function(){try{return new Blob,!0}catch(t){return!1}}(),formData:"FormData"in t,arrayBuffer:"ArrayBuffer"in t},d=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];c.prototype.clone=function(){return new c(this)},l.call(c.prototype),l.call(f.prototype),f.prototype.clone=function(){return new f(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new r(this.headers),url:this.url})},f.error=function(){var t=new f(null,{status:0,statusText:""});return t.type="error",t};var v=[301,302,303,307,308];f.redirect=function(t,e){if(v.indexOf(e)===-1)throw new RangeError("Invalid status code");return new f(null,{status:e,headers:{location:t}})},t.Headers=r,t.Request=c,t.Response=f,t.fetch=function(t,e){return new Promise(function(n,r){function o(){return"responseURL"in s?s.responseURL:/^X-Request-URL:/m.test(s.getAllResponseHeaders())?s.getResponseHeader("X-Request-URL"):void 0}var i;i=c.prototype.isPrototypeOf(t)&&!e?t:new c(t,e);var s=new XMLHttpRequest;s.onload=function(){var t=1223===s.status?204:s.status;if(t<100||t>599)return void r(new TypeError("Network request failed"));var e={status:t,statusText:s.statusText,headers:h(s),url:o()},i="response"in s?s.response:s.responseText;n(new f(i,e))},s.onerror=function(){r(new TypeError("Network request failed"))},s.ontimeout=function(){r(new TypeError("Network request failed"))},s.open(i.method,i.url,!0),"include"===i.credentials&&(s.withCredentials=!0),"responseType"in s&&y.blob&&(s.responseType="blob"),i.headers.forEach(function(t,e){s.setRequestHeader(e,t)}),s.send("undefined"==typeof i._bodyInit?null:i._bodyInit)})},t.fetch.polyfill=!0}}("undefined"!=typeof self?self:this)},{}],12:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}var o=t("./map.js"),i=r(o),s=t("./overlay.js"),a=r(s);t("es6-promise").polyfill();var l=document.getElementsByClassName("map")[0],u=document.getElementById("input"),c={center:{lat:52.3942358,lng:-2.2905},zoom:7},p=new i["default"]({el:l,defaults:c,input:u,countryCode:"GB"}),h=new a["default"](p);u.value="",window.App=h},{"./map.js":13,"./overlay.js":14,"es6-promise":3}],13:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(n,"__esModule",{value:!0});var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t},l=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u=t("events"),c=t("object.assign/polyfill"),p=r(c),h=t("./popup.js"),f=r(h),y=(0,p["default"])(),d=function(t){function e(){o(this,e);var t=i(this,Object.getPrototypeOf(e).call(this)),n=Date.now();t.body=document.body,t.settings=arguments[0],t.markers={},t.previousSettings={bounds:{north:null,east:null,south:null,west:null},lat:null,lng:null};for(var r={},s=256,l=256/180,u=256/360,c=s,p=0;p<20;)r[p]={latToPx:l*(c/s),lngToPx:u*(c/s)},c=2*c,p++;if(t.zoomLevelData=r,"object"===("undefined"==typeof google?"undefined":a(google))&&google.hasOwnProperty("maps"))t.initMap();else{var h=document.createElement("SCRIPT");window.debug===!0?h.src="https://maps.googleapis.com/maps/api/js?v=3&libraries=places&callback=Map"+n:h.src="https://maps.googleapis.com/maps/api/js?v=3&key=AIzaSyA21Xad94gjpC7J0BIdJgBhE0awlNSJuB4&libraries=places&callback=Map"+n,h.defer=!0,h.async=!0,t.body.appendChild(h),window["Map"+n]=t.initMap.bind(t)}return t}return s(e,t),l(e,[{key:"initMap",value:function(){var t=y(this.settings.defaults,{streetViewControl:!1});this.map=new google.maps.Map(this.settings.el,t),this.geocoder=new google.maps.Geocoder,this.autocomplete=new google.maps.places.Autocomplete(this.settings.input,{types:["(cities)"],componentRestrictions:{country:this.settings.countryCode}}),this.autocomplete.addListener("place_changed",this.placeChanged.bind(this)),this.emit("loaded")}},{key:"placeChanged",value:function(){var t=this.autocomplete.getPlace();t.hasOwnProperty("geometry")?this.emit("gotPlace",t):this.emit("error",{code:1,msg:"No geometry property on place object",data:t})}},{key:"getZoom",value:function(t){function e(t,e,n){for(var r=!0,o=0;r;){var i=o+1,a=e*s[i][t];a<n?o=i:r=!1}return o}var n=t.north,r=t.east,o=t.south,i=t.west,s=this.zoomLevelData,a=r-i,l=n-o,u=e("lngToPx",a,window.innerWidth),c=e("latToPx",l,window.innerHeight);return Math.min(u,c)}},{key:"updateMap",value:function(t){if(null!==t){var e=t.geometry.viewport.toJSON(),n=(t.geometry.location.lat(),t.geometry.location.lng(),e.north),r=e.east,o=e.south,i=e.west;t.bounds=e,this.map.setOptions({center:t.geometry.viewport.getCenter().toJSON(),zoom:this.getZoom(e)}),this.hasOwnProperty("rectangle")?(n!==this.previousSettings.bounds.north,r!==this.previousSettings.bounds.east,o!==this.previousSettings.bounds.south,i!==this.previousSettings.bounds.west&&(this.previousSettings.bounds={north:n,east:r,south:o,west:i},this.rectangle.setBounds(e))):(this.rectangle=new google.maps.Rectangle({bounds:e,map:this.map,fillColor:"#000000",fillOpacity:0,strokeColor:"#e64c4c",strokeOpacity:.8,strokeWeight:2}),this.previousSettings.bounds={north:n,east:r,south:o,west:i}),this.emit("updated",t)}else(0,f["default"])("Try reselecting the place you wish to see data for.")}},{key:"addMarkers",value:function(t){var e=t.key,n=t.data;if("all"===e)throw"can't use the key all";if(this.markers.hasOwnProperty(e))throw"already a property with the key "+e;var r=[];this.markers[e]=[],n.forEach(function(t){var n=t.lat,o=t.lng,i=n+"-"+o;r.indexOf(i!==-1)&&(n+=2e-4*Math.random(),o+=2e-4*Math.random(),i=n+"-"+o),r.push(i);var s=new google.maps.Marker({position:{lat:n,lng:o},map:this.map});this.markers[e].push(s)}.bind(this))}},{key:"removeMarkers",value:function(t){function e(t){t.forEach(function(t){t.setMap(null)})}if("all"===t){for(var n in this.markers)e(this.markers[n]);this.markers=[]}else e(this.markers[t]),delete this.markers[t]}}]),e}(u.EventEmitter);n["default"]=d},{"./popup.js":16,events:1,"object.assign/polyfill":10}],14:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),l=t("events"),u=t("./police-api.js"),c=t("./popup.js"),p=r(c),h=function(t){function e(t){o(this,e);var n=i(this,Object.getPrototypeOf(e).call(this));return n.map=t,n.mapData={place:null,poly:null},n.el={$place:null,$overlay:null,$submit:null,$year:null,$month:null,$policeData:null},n.eventFns={click:[],change:[]},n.possibleDates=null,n.loading=!1,n.maxDate=null,n.policeData={requestEnd:null,requestStart:null,crimes:null},n.overlay={isOpen:!1,requestStart:null,requestEnd:null,isClosing:!1},(0,u.lastUpdated)(function(t,e){if(!t){var n=e.date.split("-").slice(0,2);n=new Date(n[0],n[1]-1),this.maxDate=n.getTime(),this.init()}}.bind(n)),n}return s(e,t),a(e,[{key:"generateDates",value:function(){for(var t={},e=new Date(2012,0),n=void 0,r=void 0,o=void 0,i=void 0,s=this.maxDate;e.getTime()<s;){var a=e.getFullYear(),l=e.getMonth()+1;t.hasOwnProperty(a)||(t[a]=[]),t[a].push(l),e.setMonth(e.getMonth()+1)}n=Object.keys(t),r=n[n.length-1],o=t[r],o=o[o.length-1],this.el.$year.innerHTML=n.map(function(t){return'<option value="'+t+'">'+t+"</option>"}).join(""),i=this.el.$year.getElementsByTagName("option"),this.el.$year.value=i[i.length-1].value,this.possibleDates=t,this.setMonths(r,o),this.currentDate=r+"-"+o}},{key:"setMonths",value:function(t,e){var n=this.possibleDates[t];if(this.el.$month.innerHTML=n.map(function(t){return'<option value="'+t+'">'+t+"</option>"}).join(""),e){var r=e;n[e-1]||(r=1);this.el.$month.getElementsByTagName("option");this.el.$month.value=r}}},{key:"gotPlace",value:function(t){var e=t.geometry.viewport.toJSON(),n=e.north,r=e.south,o=e.east,i=e.west;this.mapData.place=t,this.mapData.poly=this.createPoly(n,o,r,i)}},{key:"mapError",value:function(){(0,p["default"])("An Unknown Error Occurred")}},{key:"policeDataFn",value:function(t,e){function n(t){var e=this;this.el.$policeData.innerHTML=t,setTimeout(function(){e.el.$policeData.classList.add("map-overlay__police-data--show"),e.overlay.isOpen=!0},0)}var r=this;t||e.hasOwnProperty("status")?503==e.status?(0,p["default"])("More than 10,000 crimes in this area, please select a smaller area."):(0,p["default"])("An Unknown Error Occoured"):!function(){var t={},o="",i=void 0;r.policeData.requestEnd=Date.now(),e.forEach(function(e){var n=e.category.replace(/-/g," ").split(" ").map(function(t){return t.charAt(0).toUpperCase()+t.substr(1)}).join(" ");t.hasOwnProperty(n)||(t[n]=[]),t[n].push(e)});for(var s in t)o+="<div class='map-overlay__police-data__section' data-category=\""+s+'">'+t[s].length+" x "+s+"</div>";o+='<p class="map-overlay__police-data__total">Total: '+e.length+"</p>",i=r.policeData.requestEnd-r.policeData.requestStart,r.policeData.crimes=t,r.overlay.isClosing===!1?n.call(r,[o]):r.once("OVERLAY-CLOSED",function(){n.call(this,[o])})}()}},{key:"createPoly",value:function(t,e,n,r){var o=t+","+e+":"+n+","+e+":"+n+","+r+":"+t+","+r;return o}},{key:"submitClick",value:function(){if(""===this.el.$place.value.trim())(0,p["default"])("Please select a valid place");else{var t=this.el.$year.value+"-"+this.el.$month.value;this.el.$submit.classList.add("map-overlay__button--loading"),this.map.updateMap(this.mapData.place),this.loading=!0,this.policeData.requestStart=Date.now(),this.overlay.isOpen&&this.closeOverlay(),(0,u.getData)({poly:this.mapData.poly,date:t,callback:this.policeDataFn.bind(this)})}}},{key:"closeOverlay",value:function(){var t=this;this.map.removeMarkers("all"),this.overlay.isClosing=!0,this.el.$policeData.classList.add("map-overlay__police-data--closing"),this.el.$policeData.style.transitionDelay="0.1s",setTimeout(function(){t.el.$policeData.classList.remove("map-overlay__police-data--show")},0),setTimeout(function(){
t.el.$policeData.style.transitionDelay=null,t.el.$policeData.classList.remove("map-overlay__police-data--closing"),setTimeout(function(){t.overlay.isOpen=!1,t.overlay.isClosing=!1,t.emit("OVERLAY-CLOSED")},400)},100)}},{key:"dataClick",value:function(t){var e=t.getAttribute("data-category");if(t.classList.contains("map-overlay__police-data__section--active"))t.classList.remove("map-overlay__police-data__section--active"),this.map.removeMarkers(e);else{var n=this.policeData.crimes[e].map(function(t){return{lat:parseFloat(t.location.latitude),lng:parseFloat(t.location.longitude)}});t.classList.add("map-overlay__police-data__section--active"),this.map.addMarkers({key:e,data:n})}}},{key:"yearChange",value:function(){var t=this.el.$year.value,e=this.el.$month.value;this.setMonths(t,e)}},{key:"eventHandler",value:function(t,e){var n=e.target,r=n,o=this.eventFns[e.type],i=this;Array.isArray(o)&&o.forEach(function(e){var o=!1;for(n=r;!o&&n!==t;)"string"==typeof e.el?n.classList.contains(e.el)?o=!0:n=n.parentElement:n===e.el?o=!0:n=n.parentElement;o&&e.fn.call(i,n)})}},{key:"toggleClick",value:function(t){this.el.$toggle.classList.toggle("map-overlay-toggle--open"),this.el.$overlay.classList.toggle("map-overlay--show")}},{key:"init",value:function(){this.el.$overlay=document.getElementsByClassName("map-overlay")[0],this.el.$submit=this.el.$overlay.getElementsByClassName("map-overlay__button")[0],this.el.$place=this.el.$overlay.getElementsByClassName("map-overlay__input")[0],this.el.$year=this.el.$overlay.getElementsByClassName("map-overlay__year-select")[0],this.el.$month=this.el.$overlay.getElementsByClassName("map-overlay__month-select")[0],this.el.$policeData=this.el.$overlay.getElementsByClassName("map-overlay__police-data")[0],this.el.$toggle=document.getElementsByClassName("map-overlay-toggle")[0],this.generateDates(),this.map.on("gotPlace",this.gotPlace.bind(this)).on("error",this.mapError.bind(this)),this.el.$toggle.addEventListener("click",this.toggleClick.bind(this)),this.el.$overlay.addEventListener("click",this.eventHandler.bind(this,this.el.$overlay)),this.el.$overlay.addEventListener("change",this.eventHandler.bind(this,this.el.$overlay)),this.eventFns.change.push({el:this.el.$year,fn:this.yearChange}),this.eventFns.click.push({el:this.el.$submit,fn:this.submitClick}),this.eventFns.click.push({el:"map-overlay__police-data__section",fn:this.dataClick}),this.el.$overlay.classList.add("map-overlay--show")}}]),e}(l.EventEmitter);n["default"]=h},{"./police-api.js":15,"./popup.js":16,events:1}],15:[function(t,e,n){"use strict";function r(t){var e=t.date,n=t.poly,r=t.callback,o="?poly="+n+"&date="+e;s.hasOwnProperty(o)?r.apply(null,s[o]):fetch(i+o).then(function(t){return 200===t.status?t.json():{status:t.status,statusText:t.statusText}}).then(function(t){s[o]=[null,t],r(null,t)})["catch"](function(t){s[o]=[t],r(t)})}function o(t){fetch("https://data.police.uk/api/crime-last-updated").then(function(t){return t.json()}).then(function(e){t(null,e)})["catch"](function(e){t(e)})}Object.defineProperty(n,"__esModule",{value:!0}),n.getData=r,n.lastUpdated=o,t("whatwg-fetch");var i="https://data.police.uk/api/crimes-street/all-crime",s={}},{"whatwg-fetch":11}],16:[function(t,e,n){"use strict";function r(){s.classList.remove("alert--open")}function o(){s.classList.add("alert--open")}function i(t){c.innerHTML=t,setTimeout(function(){o()},0)}Object.defineProperty(n,"__esModule",{value:!0}),n["default"]=i;var s=document.body,a=document.createElement("DIV"),l=document.createElement("DIV"),u=document.createElement("BUTTON"),c=document.createElement("DIV");l.classList.add("alert__container"),u.classList.add("alert__close"),u.addEventListener("click",r),c.classList.add("alert__content"),u.innerHTML="Close",a.classList.add("alert"),a.appendChild(l),l.appendChild(u),l.appendChild(c),s.appendChild(a)},{}]},{},[12]);
//# sourceMappingURL=main.min.js.map
